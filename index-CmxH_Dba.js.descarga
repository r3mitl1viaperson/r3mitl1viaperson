var Tr=Object.defineProperty;var Lr=(e,t,n)=>t in e?Tr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var u=(e,t,n)=>(Lr(e,typeof t!="symbol"?t+"":t,n),n);import{B as Ar,i as _o,a as Rr,b as Or,g as We,c as Z,l as Sr,d as go,e as Mr,f as Ae,h as Fr,R as l,j as o,F as xn,k as Ut,m as fn,L as Ce,u as Nt,A as Br,M as In,n as wo,o as bn,T,p as Ur,q as xo,r as Nr,I as ee,s as $e,t as bo,v as $r,w as yn,x as Xn,D as yo,y as vo,C as jo,V as M,z as re,E as Co,G as zr,H as Wr,O as $t,J as d,S as A,K as Po,N as ko,P as Tn,Q as zt,U as Hr,W as St,X as Eo,Y as Wt,Z as Do,_ as Gr,$ as Vr,a0 as qr,a1 as Kr,a2 as Io,a3 as To,a4 as Ht,a5 as Lo,a6 as rt,a7 as gt,a8 as st,a9 as at,aa as Yr,ab as Xr,ac as Jr,ad as Jn,ae as Qr,af as Zr,ag as Ao,ah as Ro,ai as es,aj as ts,ak as ns,al as os,am as rs,an as ss,ao as as,ap as Le,aq as is,ar as j,as as Qn,at as ls,au as cs,av as us,aw as ds,ax as fs,ay as ps,az as ms,aA as hs,aB as _s,aC as gs,aD as ws,aE as xs,aF as bs,aG as ys,aH as vs,aI as js,aJ as Cs,aK as Ps,aL as Zn,aM as ks,aN as Es,aO as Ds,aP as Is,aQ as Ts,aR as Ls,aS as As,aT as Rs,aU as Os,aV as Ss,aW as Ms,aX as Fs,aY as Bs,aZ as Us,a_ as Ns,a$ as Oo,b0 as $s,b1 as Gt,b2 as Ye,b3 as zs,b4 as Ws,b5 as Hs,b6 as Gs,b7 as Vs,b8 as qs,b9 as Ks,ba as Ys,bb as Xs,bc as Js}from"./dependencies-DrsuBKgt.js";import"./index-CmxH_Dba.js";function Xc(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();var Zc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function eu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function tu(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}),n}const Qs="modulepreload",Zs=function(e,t){return e[0]==="."?new URL(e,t).href:e},eo={},Q=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){const a=document.getElementsByTagName("link"),i=document.querySelector("meta[property=csp-nonce]"),p=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.all(n.map(c=>{if(c=Zs(c,r),c in eo)return;eo[c]=!0;const f=c.endsWith(".css"),g=f?'[rel="stylesheet"]':"";if(!!r)for(let b=a.length-1;b>=0;b--){const x=a[b];if(x.href===c&&(!f||x.rel==="stylesheet"))return}else if(document.querySelector('link[href="'.concat(c,'"]').concat(g)))return;const _=document.createElement("link");if(_.rel=f?"stylesheet":Qs,f||(_.as="script",_.crossOrigin=""),_.href=c,p&&_.setAttribute("nonce",p),document.head.appendChild(_),f)return new Promise((b,x)=>{_.addEventListener("load",b),_.addEventListener("error",()=>x(new Error("Unable to preload CSS for ".concat(c))))})}))}return s.then(()=>t()).catch(a=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a})},ea=(e,t)=>{const n=e[t];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((r,s)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+t)))})};function nu(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}const ta=new Ar,na={order:["cookie","navigator"],lookupCookie:Sr},oa=new Map([["zh_CN","zh"]]),ra=new Map(Array.from(oa.entries(),e=>e.reverse())),So="en";_o.use(Rr).use(Or).use(ta).init({backend:{async loadPath(e){for(const t of e.map(n=>{var r;return(r=ra.get(n))!=null?r:n}))try{return(await ea(Object.assign({"../../../loc/bn.json":()=>Q(()=>Promise.resolve().then(()=>pc),[],import.meta.url),"../../../loc/de.json":()=>Q(()=>Promise.resolve().then(()=>hc),void 0,import.meta.url),"../../../loc/en.json":()=>Q(()=>Promise.resolve().then(()=>gc),void 0,import.meta.url),"../../../loc/es.json":()=>Q(()=>Promise.resolve().then(()=>xc),void 0,import.meta.url),"../../../loc/fr.json":()=>Q(()=>Promise.resolve().then(()=>yc),void 0,import.meta.url),"../../../loc/hi.json":()=>Q(()=>Promise.resolve().then(()=>jc),void 0,import.meta.url),"../../../loc/it.json":()=>Q(()=>Promise.resolve().then(()=>Pc),void 0,import.meta.url),"../../../loc/ja.json":()=>Q(()=>Promise.resolve().then(()=>Ec),void 0,import.meta.url),"../../../loc/ko.json":()=>Q(()=>Promise.resolve().then(()=>Ic),void 0,import.meta.url),"../../../loc/nl.json":()=>Q(()=>Promise.resolve().then(()=>Lc),void 0,import.meta.url),"../../../loc/pl.json":()=>Q(()=>Promise.resolve().then(()=>Rc),void 0,import.meta.url),"../../../loc/pt.json":()=>Q(()=>Promise.resolve().then(()=>Sc),void 0,import.meta.url),"../../../loc/ro.json":()=>Q(()=>Promise.resolve().then(()=>Fc),void 0,import.meta.url),"../../../loc/th.json":()=>Q(()=>Promise.resolve().then(()=>Uc),void 0,import.meta.url),"../../../loc/tl.json":()=>Q(()=>Promise.resolve().then(()=>$c),void 0,import.meta.url),"../../../loc/tr.json":()=>Q(()=>Promise.resolve().then(()=>Wc),void 0,import.meta.url),"../../../loc/vi.json":()=>Q(()=>Promise.resolve().then(()=>Gc),void 0,import.meta.url),"../../../loc/zh_CN.json":()=>Q(()=>Promise.resolve().then(()=>qc),void 0,import.meta.url)}),"../../../loc/".concat(t,".json"))).default}catch(n){console.warn("failed to load language ".concat(t))}return!1}},fallbackLng:So,detection:na,interpolation:{escapeValue:!1,prefix:We.interpolationPrefix,suffix:We.interpolationSuffix},missingInterpolationHandler(e){Z.notify("MissingLocalizationReplacement",t=>{t.addMetadata("MissingLocalizationReplacement",{text:e})})}});function sa(){if(!("addEventListener"in window.XMLHttpRequest.prototype))return;const e=window.XMLHttpRequest.prototype.open;window.XMLHttpRequest.prototype.open=function(n,r){if(r.toString().startsWith("https://translate.googleapis.com/translate_a/t")){const s=new URL(r);Z.leaveBreadcrumb("googleTranslate",{sourceLanguage:s.searchParams.get("sl"),targetLanguage:s.searchParams.get("tl")})}e.apply(this,arguments)}}sa();class Y extends Error{constructor(t,n){super("ResponseError: ".concat(t.url," ").concat(t.status),n),this.response=t}}function Re(e,{body:t,...n}){const r={...n.headers,accept:"application/json"};return t&&(r["content-type"]="application/json"),fetch(e,{...n,body:t?JSON.stringify(t.serialize()):void 0,headers:r})}function aa(e=window){return{load:t=>{"addEventListener"in e&&(t.addOnBreadcrumb(n=>{var r;if(n.type==="user")if((r=n.metadata)!=null&&r[pn])delete n.metadata[pn];else return!1}),e.addEventListener("click",n=>{let r,s;try{r=n.target?ca(n.target):"[unknown]",s=Mo(n.target,e)}catch(a){r="[hidden]",s="[hidden]"}t.leaveBreadcrumb("UI click",{targetText:r,targetSelector:s,[pn]:!0},"user")},!0))}}}const pn="__custom-plugin-interaction-breadcrumb__",ia=/^\s+/,la=/(^|[^\s])\s+$/;function ca(e){let t=e.textContent||e.innerText||"";return!t&&(e.type==="submit"||e.type==="button")&&(t=e.value),t=t.replace(ia,"").replace(la,"$1"),t.length>140?t.slice(0,135)+"(...)":t}function Mo(e,t){var r;const n=[e.tagName.toLowerCase()];if(e.dataset.testid?n.push('[data-testid="'.concat(e.dataset.testid,'"]')):e.id?n.push("#"+e.id):e.getAttribute("src")?n.push('[src="'.concat(e.getAttribute("src"),'"]')):(r=e.className)!=null&&r.length&&n.push(".".concat(e.className.split(" ").join("."))),!t.document.querySelectorAll||!Array.prototype.indexOf)return n.join("");try{if(t.document.querySelectorAll(n.join("")).length===1)return n.join("")}catch(s){return n.join("")}if(e.parentNode.childNodes.length>1){const s=Array.prototype.indexOf.call(e.parentNode.childNodes,e)+1;n.push(":nth-child(".concat(s,")"))}return t.document.querySelectorAll(n.join("")).length===1?n.join(""):e.parentNode?"".concat(Mo(e.parentNode,t)," > ").concat(n.join("")):n.join("")}const Lt=document.getElementById("auth-ui-config");if(!(Lt!=null&&Lt.textContent))throw new Error("failed to find config from #auth-ui-config");const mn=go(Lt.textContent),K={...mn,BUGSNAG_API_KEY:mn.CLIENT_BUGSNAG_API_KEY,IS_DEV:mn.APP_DOMAIN==="local"};window.CDN_URL=K.CDN_URL;function ua(){const e=[];K.RECAPTCHA_SITE_KEY&&e.push({name:"auth-ui.enable_recaptcha"}),Z.start({apiKey:K.BUGSNAG_API_KEY,appVersion:K.APP_VERSION,releaseStage:K.APP_DOMAIN,plugins:[new Mr,aa(window)],metadata:{Device:{authDeviceEnvironmentId:Ae.get(Fr)}},featureFlags:e,onBreadcrumb(t){var n;if(t.type==="navigation"&&(delete t.metadata.state,delete t.metadata.prevState),t.type==="request"&&((n=t.metadata.request)!=null&&n.startsWith("POST https://bam.nr-data.net/")))return!1},onError:da,logger:K.APP_DOMAIN=="prod"?null:void 0})}function da(e){let t=e.originalError;for(;t;){if(!(t instanceof Error)){e.addMetadata("Cause",t);break}t instanceof Y&&e.addMetadata("Response",{url:t.response.url,status:t.response.status,redirected:t.response.redirected}),t=t.cause}Z.addMetadata("Document",{hidden:document.hidden,visibilityState:document.visibilityState,online:window.navigator.onLine});const n=e.errors[e.errors.length-1];if(n.stacktrace.length>0&&n.stacktrace[0].file.startsWith(location.origin)&&(e.groupingHash=e.errors.map(r=>r.errorMessage).join(" | ")),n.stacktrace.length>0&&(n.stacktrace[n.stacktrace.length-1].file=="global code"||n.stacktrace[0].file.startsWith("https://js-agent.newrelic.com/")||n.stacktrace.some(({file:r})=>r.startsWith("webkit-masked-url://"))||n.stacktrace.some(({file:r})=>r.startsWith("unknown:1"))||n.stacktrace.filter(({file:r})=>r.startsWith(location.origin)).length>=2||n.stacktrace[0].file.startsWith(location.origin)&&n.stacktrace[0].lineNumber==1)||e.originalError instanceof Error&&(e.originalError.name=="TypeError"&&(e.originalError.message=="undefined is not an object (evaluating 'a.N')"||e.originalError.message=="undefined is not an object (evaluating 'window.webkit.messageHandlers')"||e.originalError.message=="Properties can only be defined on Objects.")||e.originalError.name=="ReferenceError"&&(e.originalError.message=="Can't find variable: AlipayH5Share"||e.originalError.message=="Can't find variable: AlipayJSBridge")))return!1;if(e.errors[0].errorClass=="InvalidError"&&e.errors[0].errorMessage=='unhandledrejection handler received a non-error. See "unhandledrejection handler" tab for more detail.'){const r=e.getMetadata("unhandledrejection handler","non-error parameter");if(e.groupingHash="unhandledrejection handler received a non-error: "+r,e.originalError===void 0||e.originalError==="Timeout"||e.originalError.startsWith("Object Not Found Matching Id"))return!1}return K.IS_DEV?(console.warn(e),!1):(newrelic.noticeError(e.originalError),!0)}function fa(){return Z.getPlugin("react").createErrorBoundary(l)}window.addEventListener("unload",()=>Z.leaveBreadcrumb("unload"));document.addEventListener("visibilitychange",()=>Z.leaveBreadcrumb("visibilitychange",{visibilityState:document.visibilityState}));window.addEventListener("online",()=>Z.leaveBreadcrumb("online"));window.addEventListener("offline",()=>Z.leaveBreadcrumb("offline"));document.addEventListener("securitypolicyviolation",e=>Z.leaveBreadcrumb("securitypolicyviolation",{blockedURI:e.blockedURI,violatedDirective:e.violatedDirective,originalPolicy:e.originalPolicy,sample:e.sample,referrer:e.referrer}));window.addEventListener("unhandledrejection",e=>{e.reason=="Timeout"&&e.preventDefault()});const Fo=l.createContext(!1);function Ln(){return l.useContext(Fo)}const Bo=l.createContext(()=>{throw new Error("no loading context")});function Je(){return l.useContext(Bo)}function Uo(e){return o.jsx(Fo.Provider,{value:e.state[0],children:o.jsx(Bo.Provider,{value:e.state[1],children:o.jsxs(xn,{alignItems:"stretch",w:"100%",flexDirection:"column",children:[e.children,e.state[0]&&o.jsx(Ut,{position:"absolute",zIndex:"100",h:"100%",w:"100%",bgColor:"rgba(255, 255, 255, 0.5)","aria-busy":!0})]})})})}function No(e){return!!e.href}function pa(e){var t;return(t=e.submits)!=null?t:!1}var W=(e=>(e.Outline="outline",e.Ghost="ghost",e.Link="link",e.Social="social",e))(W||{});const R=l.forwardRef(function({title:t,buttonType:n,disabled:r,testID:s,size:a,leftIcon:i,...p},c){const f=Ln(),g={"data-testid":s,variant:n,size:a};return No(p)?o.jsx(fn,{...g,display:"block",width:"100%",textAlign:"center",as:Ce,href:p.href,...p.hrefAttrs,onClick:p.onPress,ref:c,leftIcon:i,children:t}):pa(p)?o.jsx(fn,{...g,isDisabled:f||r,type:"submit",ref:c,leftIcon:i,children:t}):o.jsx(fn,{...g,isDisabled:f||r,onClick:p.onPress,ref:c,leftIcon:i,children:t})});function hn({button:{leastDestructiveRef:e,...t},buttonType:n}){return o.jsx(R,{buttonType:n,size:"sm",...t,ref:e})}function ke({title:e,body:t,testID:n,primaryButton:r,secondaryButton:s,tertiaryButton:a}){const i=l.useMemo(()=>e?o.jsx(wo,{children:e}):null,[e]),p=l.useMemo(()=>t?typeof t=="string"?o.jsx(bn,{children:o.jsx(T,{children:t})}):o.jsx(bn,{children:t}):null,[t]);return o.jsxs(Ur,{"data-testid":n,children:[i,p,o.jsxs(xo,{children:[o.jsx(hn,{button:r}),s?o.jsx(hn,{button:s,buttonType:W.Outline}):null,a?o.jsx(hn,{button:a,buttonType:W.Link}):null]})]})}const $o=l.createContext({show(){throw new Error("ModalProvider was not initialized")},hide(){throw new Error("ModalProvider was not initialized")}});function ma({children:e}){const{isOpen:t,onOpen:n,onClose:r}=Nt(),[s,a]=l.useState(null),i=l.useRef(null),p=l.useMemo(()=>({show:c=>{a(c(i)),n()},hide:r}),[r,n]);return o.jsxs($o.Provider,{value:p,children:[e,o.jsx(Br,{variant:"alertDialog",isOpen:t,onClose:r,leastDestructiveRef:i,children:o.jsx(In,{children:s})})]})}function Vt(){return l.useContext($o)}const zo=""+window.CDN_URL+"assets/remitly-badge-Cg5zrdrr.svg",ha=""+window.CDN_URL+"assets/remitly-logo-horizontal-ClQP0srv.svg";function _a(){const[e]=Nr("(min-width: 800px)");return e?o.jsx(xn,{justifyContent:"center",p:"lg",mb:"xl",borderBottomStyle:"solid",borderBottomWidth:"1px",borderBottomColor:"blue.100",children:o.jsx(ee,{src:ha,objectFit:"contain",height:"40px",width:"169px",alt:""})}):o.jsx(xn,{justifyContent:"center",p:"md",boxShadow:"md",children:o.jsx(ee,{src:zo,objectFit:"contain",height:"40px",width:"34px",alt:""})})}const to=l.createContext(Promise.resolve()),no="Remitly";function ga(){return l.useRef((()=>{let e=()=>{throw new Error("the promise should set this up")};const t=new Promise(n=>{e=n});return{done:e,promise:t}})()).current}function ce({suffix:e,children:t}){const n=l.useContext(to),r=ga();return l.useEffect(()=>{let s=document.title;return n.then(()=>{s=document.title,document.title=e?[no,e].join(" | "):no,r.done()}),()=>{document.title=s}},[n,r,e]),o.jsx(to.Provider,{value:r.promise,children:t})}function At({title:e,testID:t,...n}){const r=Ln(),s={"data-testid":t,fontWeight:"bold",color:"brand.600"};return No(n)?o.jsx(Ce,{href:n.href,...n.hrefAttrs,onClick:n.onPress,...s,children:e}):o.jsx(T,{as:"span",role:"button",onClick:r?void 0:n.onPress,...s,children:e})}const Wo=""+window.CDN_URL+"assets/shield-By7xJ2a8.svg",wa=[We.boldKeyRegex,We.italicsKeyRegex,We.replacementKeyRegex];function Ho(e,t,n){if(t.length<=0)return[e];const r=t[0];return e.split(r).flatMap((i,p)=>{const c=Ho(i,t.slice(1),n);if(p%2===0)return c;const f=Math.random();switch(r){case We.boldKeyRegex:return o.jsx(T,{as:"b",children:c},f);case We.italicsKeyRegex:return o.jsx(T,{as:"i",children:c},f);case We.replacementKeyRegex:return n?o.jsx($e.Fragment,{children:n[i]},f):null}})}function C(){const{t:e}=bo();return $e.useCallback(function(n,r){return e(n,r)},[e])}function it(){const e=C();return $e.useCallback(function(r,s){const a={},i={};s&&Object.entries(s).forEach(([c,f])=>{typeof f=="string"||typeof f=="number"?a[c]=f:(a[c]="{".concat(c,"}"),i[c]=f)});const p=e(r,a);return Ho(p,wa,i)},[e])}function Oe(){var e;return(e=_o.resolvedLanguage)!=null?e:So}const xa="https://www.remitly.com/home/cookies",Go="https://help.remitly.com/s/article/two-factor-authentication-verification?language=".concat(Oe()),ba="https://help.remitly.com/s/article/account-locked?language=".concat(Oe(),"&utm_source=remitly&utm_medium=front_end"),ya="https://help.remitly.com/s/article/account-suspended?language=".concat(Oe(),"&utm_source=remitly&utm_medium=front_end"),va="https://help.remitly.com/s/article/reset-password?language=".concat(Oe(),"#forgot-password"),ja="https://help.remitly.com/";function oo(e){return"https://www.remitly.com/".concat(e,"/").concat(Oe(),"/home/policy")}function ro(e){return"https://www.remitly.com/".concat(e,"/").concat(Oe(),"/home/agreement")}function Ca(e){return"https://www.remitly.com/".concat(e,"/").concat(Oe(),"/home/agreement#13-e-sign-disclosure--consent-notice")}const ue={target:"_blank",rel:"noopener"},Vo=Ae.get($r),qo=Ae.get(yn),Pa=Vo==="NONE"||qo==="1";function ka(){const{isOpen:e,onClose:t}=Nt({defaultIsOpen:Vo!=="NONE"&&!qo}),n=l.useCallback(()=>{Ae.set(yn,"0",{expires:Xn(),sameSite:"lax"}),t()},[t]),r=l.useCallback(()=>{Ae.set(yn,"1",{expires:Xn(),sameSite:"lax"}),location.reload(),t()},[t]);return o.jsxs(yo,{placement:"bottom",onClose:t,isOpen:e,closeOnOverlayClick:!1,children:[o.jsx(In,{}),o.jsx(vo,{"data-testid":"cookie-consent-banner",p:"md",children:o.jsx(jo,{children:o.jsxs(M,{gap:"md",alignItems:"stretch",fontSize:"sm",children:[o.jsx(re,{children:o.jsx(ee,{src:Wo,height:"40px",width:"40px",alt:""})}),o.jsxs(M,{gap:"sm",alignItems:"initial",children:[o.jsx(T,{children:"Want to help us improve your experience? Accept optional cookies."}),o.jsxs(T,{children:["Enabling these optional cookies helps us collect data to provide you with a better, more personalized experience. To learn more, see our"," ",o.jsx(At,{href:xa,title:"Cookie Policy"}),"."]})]}),o.jsxs(M,{gap:"sm",alignItems:"stretch",children:[o.jsx(R,{testID:"cookie-consent-banner-accept",title:"Accept",size:"sm",onPress:r}),o.jsx(R,{testID:"cookie-consent-banner-reject",title:"Decline",size:"sm",buttonType:W.Outline,onPress:n})]})]})})})]})}const pe=new URL(K.AUTH_PUBLIC_PROXY_URL||location.origin),me=Symbol("api_error"),H=Symbol("auth_failed"),qt=Symbol("auth_locked"),Kt=Symbol("auth_suspended"),Ee=Symbol("rate_limited"),Yt=Symbol("bot_detected");function Ko(e){return t=>{for(;t;){if(e(t))return!0;t instanceof Error?t=t.cause:t=null}return!1}}const Ea=Ko(e=>e instanceof Error&&e.name=="TypeError"&&e.message=="Failed to fetch");function he(e){return t=>Promise.reject(new Error(e,{cause:t}))}function Da(e){return setTimeout(e,1e3/60)}const Ia=typeof requestAnimationFrame=="function"?window?requestAnimationFrame.bind(window):requestAnimationFrame:Da,Ta="https://uel.remitly.io/v1/events",La={"remitly-uel-payload-type":"1","content-type":"application/json"},Rt=[];let vn=null;function Aa(e){Rt.push(e),vn==null&&(vn=Ia(Mt))}const Ra="keepalive"in new Request(location.origin);async function Mt(){if(!Rt.length){vn=null;return}const e=Rt.splice(0,Rt.length),t=fetch(Ta,{method:"POST",headers:La,body:JSON.stringify(e),keepalive:!0}).catch(n=>{Ea(n)||Co.notify(n)});if(Ra)Mt();else return await t,Mt()}function lt(e,t,n){const r={app:K.APP_NAME,application_log_timestamp:Date.now(),domain:K.APP_DOMAIN,event_id:zr(),event_name:t,parent_schema_names:Wr.schemas[e].parentSchemas,schema_name:e},s={...n,...r};K.IS_DEV&&(console.groupCollapsed&&console.groupCollapsed("UEL %c".concat(e.split("/")[0],":").concat(t),"color: #9400D3"),console.log(s),console.groupEnd&&console.groupEnd()),Aa(s)}async function xe(e,t){const n=$t.deserialize(e);if(n!=null&&n.redirectURI)return Ft(n,t)}async function Ft(e,t){try{await(t==null?void 0:t()),await Mt()}catch(n){Z.notify(n)}return window.location.replace(e.redirectURI),new Promise(()=>{})}var Oa=Object.defineProperty,Sa=Object.getOwnPropertyDescriptor,be=(e,t,n,r)=>{for(var s=r>1?void 0:r?Sa(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&Oa(t,n,s),s};class Xt extends A{constructor(){super(...arguments);u(this,"oidcHandoff");u(this,"authFlow")}}be([d("oidc_handoff",$t)],Xt.prototype,"oidcHandoff",2);be([d("auth_flow")],Xt.prototype,"authFlow",2);class He extends A{constructor(){super(...arguments);u(this,"clientName");u(this,"userAddress");u(this,"scopes");u(this,"logoUri");u(this,"policyUri");u(this,"tosUri");u(this,"contractUri")}}be([d("client_application")],He.prototype,"clientName",2);be([d("user_address")],He.prototype,"userAddress",2);be([d("requested_scopes")],He.prototype,"scopes",2);be([d("logo_uri")],He.prototype,"logoUri",2);be([d("policy_uri")],He.prototype,"policyUri",2);be([d("tos_uri")],He.prototype,"tosUri",2);be([d("contract_uri")],He.prototype,"contractUri",2);var Ot=(e=>(e.Accept="accept",e.Reject="reject",e.RejectAndRestartLogin="reject_and_restart_login",e))(Ot||{});class Jt extends A{constructor(){super(...arguments);u(this,"consentAction");u(this,"challenge");u(this,"scopes")}}be([d("consent_action")],Jt.prototype,"consentAction",2);be([d("consent_challenge")],Jt.prototype,"challenge",2);be([d("grant_scope")],Jt.prototype,"scopes",2);async function _n(e,t){const n=await Re(new URL("/orchestrator/v1/consent",pe),{method:"POST",body:Jt.with(e),signal:t}).catch(he("failed to post consent"));throw n.status!=200?new Y(n):(await xe(await n.json(),null),new Y(n))}function V(e){throw new Error("Unhandled discriminated union member")}var Ma=Object.defineProperty,Fa=Object.getOwnPropertyDescriptor,Yo=(e,t,n,r)=>{for(var s=r>1?void 0:r?Fa(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&Ma(t,n,s),s};class An extends A{constructor(){super(...arguments);u(this,"lastFour")}}Yo([d("phone_last_four")],An.prototype,"lastFour",2);class wt extends An{}class xt extends An{}class ct extends A{constructor(){super(...arguments);u(this,"hint")}}Yo([d("hint")],ct.prototype,"hint",2);const Xe=Symbol("push_mfa"),jn={sms:wt,voice_call:xt,email:ct,push:Xe},bt=Po(function(t){for(const[n,r]of Object.entries(jn)){if(t==r)return{[n]:{}};if(typeof r!="symbol"&&t instanceof r)return{[n]:ko(r,t)}}return null},function(t){if(!t||typeof t!="object"||Array.isArray(t))return null;for(const[n,r]of Object.entries(jn))if(n in t)return typeof r=="symbol"?r:Tn(r,t[n]);return null});function Ue(e){for(const[t,n]of Object.entries(jn))if(typeof n!="symbol"&&e instanceof n||n==e)return t;return null}function Cn(e){if(e==null||e.length==0)return null;const t=[];for(const n of e){const r=Ue(n);r!=null&&t.push(r)}return t.length>0?t:null}var Ba=Object.defineProperty,Ua=Object.getOwnPropertyDescriptor,Xo=(e,t,n,r)=>{for(var s=r>1?void 0:r?Ua(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&Ba(t,n,s),s};let yt=class extends A{constructor(){super(...arguments);u(this,"type");u(this,"value")}};Xo([d],yt.prototype,"type",2);Xo([d],yt.prototype,"value",2);var Na=Object.defineProperty,$a=Object.getOwnPropertyDescriptor,q=(e,t,n,r)=>{for(var s=r>1?void 0:r?$a(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&Na(t,n,s),s};class Qt extends A{constructor(){super(...arguments);u(this,"option");u(this,"expiresAfterMillis");u(this,"devOnlyCode",null)}}q([d("option",bt)],Qt.prototype,"option",2);q([d("expires_after_millis")],Qt.prototype,"expiresAfterMillis",2);q([d("__dev_only_code__")],Qt.prototype,"devOnlyCode",2);class Rn extends A{constructor(){super(...arguments);u(this,"mfa_options");u(this,"register_auto_login")}}q([d("mfa_options",zt(bt))],Rn.prototype,"mfa_options",2);q([d("register_auto_login")],Rn.prototype,"register_auto_login",2);class On extends A{constructor(){super(...arguments);u(this,"options");u(this,"codeData")}}q([d("options",Rn)],On.prototype,"options",2);q([d("code_data",Qt)],On.prototype,"codeData",2);class Zt extends A{constructor(){super(...arguments);u(this,"step");u(this,"factors");u(this,"mfa")}}q([d("step")],Zt.prototype,"step",2);q([d("factors")],Zt.prototype,"factors",2);q([d("mfa",On)],Zt.prototype,"mfa",2);class Se extends A{constructor(){super(...arguments);u(this,"authToken");u(this,"steps");u(this,"productLineUserId");u(this,"oidcClientID");u(this,"loginIdentifier");u(this,"linkingLoginIdentifier");u(this,"challenge");u(this,"requiredAuthFactor");u(this,"additionalSteps")}}q([d("auth_token")],Se.prototype,"authToken",2);q([d("steps",zt(Zt))],Se.prototype,"steps",2);q([d("product_line_user_id")],Se.prototype,"productLineUserId",2);q([d("oidc_client_id")],Se.prototype,"oidcClientID",2);q([d("login_identifier",yt)],Se.prototype,"loginIdentifier",2);q([d("linking_login_identifier",yt)],Se.prototype,"linkingLoginIdentifier",2);q([d("challenge")],Se.prototype,"challenge",2);q([d("required_auth_factors")],Se.prototype,"requiredAuthFactor",2);q([d("additional_steps")],Se.prototype,"additionalSteps",2);const de=Po(e=>e.raw,e=>{const t=Hr(e),n=Tn(Se,t);if(!n)throw new Error("failed to deserialize state token fields");return{raw:e,...n}});class Ge extends A{constructor(){super(...arguments);u(this,"stateToken")}}q([d("state_token",de)],Ge.prototype,"stateToken",2);var za=Object.defineProperty,Wa=Object.getOwnPropertyDescriptor,De=(e,t,n,r)=>{for(var s=r>1?void 0:r?Wa(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&za(t,n,s),s};class Ve extends A{constructor(){super(...arguments);u(this,"option");u(this,"expiresAfterMillis");u(this,"devOnlyCode",null);u(this,"stateToken")}}De([d("mfa_option",bt)],Ve.prototype,"option",2);De([d("expires_after_millis")],Ve.prototype,"expiresAfterMillis",2);De([d("__dev_only_code__")],Ve.prototype,"devOnlyCode",2);De([d("state_token",de)],Ve.prototype,"stateToken",2);class qe extends A{constructor(){super(...arguments);u(this,"challenge");u(this,"authToken");u(this,"stateToken");u(this,"language");u(this,"mfaType");u(this,"rememberDevice");u(this,"recaptchaToken")}}De([d("login_challenge")],qe.prototype,"challenge",2);De([d("auth_token")],qe.prototype,"authToken",2);De([d("state_token",de)],qe.prototype,"stateToken",2);De([d],qe.prototype,"language",2);De([d("mfa_type")],qe.prototype,"mfaType",2);De([d("remember_device")],qe.prototype,"rememberDevice",2);De([d("recaptcha_token")],qe.prototype,"recaptchaToken",2);async function Ha(e,t,n){const r=await Re(new URL("/orchestrator/v1/mfa/generate",pe),{method:"POST",body:qe.with({language:Oe(),...e}),signal:t}).catch(he("failed to generate MFA"));switch(r.status){case 200:{const s=await r.json();if(await xe(s,n),s.state_token!==null){const i=Ge.deserialize(s);if(i!=null&&i.stateToken)return i}const a=Ve.deserialize(s);if(a)return a;break}case 401:return H;case 429:return Ee}throw new Y(r)}var Ga=Object.defineProperty,Va=Object.getOwnPropertyDescriptor,I=(e,t,n,r)=>{for(var s=r>1?void 0:r?Va(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&Ga(t,n,s),s};class oe extends A{constructor(){super(...arguments);u(this,"authToken");u(this,"options");u(this,"stateToken",null);u(this,"productLineUserId");u(this,"oidcClientId");u(this,"registerAutoLogin")}}I([d("auth_token")],oe.prototype,"authToken",2);I([d("mfa_options",zt(bt))],oe.prototype,"options",2);I([d("state_token",de)],oe.prototype,"stateToken",2);I([d("product_line_user_id")],oe.prototype,"productLineUserId",2);I([d("oidc_client_id")],oe.prototype,"oidcClientId",2);I([d("register_auto_login")],oe.prototype,"registerAutoLogin",2);class et extends A{constructor(){super(...arguments);u(this,"registerAutoLoginOidcHandoff");u(this,"restartOidcHandoff")}}I([d("register_auto_login_oidc_handoff",$t)],et.prototype,"registerAutoLoginOidcHandoff",2);I([d("restart_oidc_handoff",$t)],et.prototype,"restartOidcHandoff",2);class ne extends A{constructor(){super(...arguments);u(this,"mfaRequiredResponse");u(this,"mfaGeneratedResponse")}}I([d("mfa_required",oe)],ne.prototype,"mfaRequiredResponse",2);I([d("mfa_generated",Ve)],ne.prototype,"mfaGeneratedResponse",2);class qa extends A{constructor(){super(...arguments);u(this,"email")}}I([d("email")],qa.prototype,"email",2);class Sn extends A{constructor(){super(...arguments);u(this,"mfaOptions");u(this,"generatedMfaCode")}}I([d("mfa_options",zt(bt))],Sn.prototype,"mfaOptions",2);I([d("generated_mfa_code",Ve)],Sn.prototype,"generatedMfaCode",2);class le extends A{constructor(){super(...arguments);u(this,"hint");u(this,"clientName");u(this,"_resumeAuthResponse");u(this,"stateToken",null);u(this,"confirmAccount");u(this,"registerAccount");u(this,"preselectMarketingSubscription");u(this,"showMarketingSubscription");u(this,"passwordReset");u(this,"rpDeviceEnvironmentId",null);u(this,"country");u(this,"showSSO");u(this,"_resumeMfa")}get resumeMfa(){if(this._resumeMfa!==void 0)return this._resumeMfa;const n=Ae.get(St);return n&&this._resumeAuthResponse?this._resumeMfa=ne.with({mfaRequiredResponse:oe.with({options:this._resumeAuthResponse.mfaOptions,authToken:n}),mfaGeneratedResponse:this._resumeAuthResponse.generatedMfaCode}):this._resumeMfa=null,this._resumeMfa}get rootPage(){return this.confirmAccount?"confirm_account":this.passwordReset?"password_reset":this.registerAccount?"register":"login"}}I([d("login_hint")],le.prototype,"hint",2);I([d("client_name")],le.prototype,"clientName",2);I([d("resume_auth",Sn)],le.prototype,"_resumeAuthResponse",2);I([d("state_token",de)],le.prototype,"stateToken",2);I([d("confirm_account")],le.prototype,"confirmAccount",2);I([d("register_account")],le.prototype,"registerAccount",2);I([d("preselect_marketing_subscription")],le.prototype,"preselectMarketingSubscription",2);I([d("show_marketing_subscription")],le.prototype,"showMarketingSubscription",2);I([d("password_reset")],le.prototype,"passwordReset",2);I([d("device_environment_id")],le.prototype,"rpDeviceEnvironmentId",2);I([d("country")],le.prototype,"country",2);I([d("show_sso")],le.prototype,"showSSO",2);const Jo=Symbol("address_conflict"),ht=Symbol("invalid_email"),en=Symbol("invalid_password");class tn extends A{constructor(){super(...arguments);u(this,"challenge");u(this,"nonce1");u(this,"nonce2")}}I([d],tn.prototype,"challenge",2);I([d],tn.prototype,"nonce1",2);I([d],tn.prototype,"nonce2",2);class Mn extends A{constructor(){super(...arguments);u(this,"type");u(this,"value")}}I([d],Mn.prototype,"type",2);I([d],Mn.prototype,"value",2);class Me extends A{constructor(){super(...arguments);u(this,"loginIdentifier");u(this,"password");u(this,"challenge");u(this,"marketingSubscriptionStatus");u(this,"mfaTypes");u(this,"proofOfWorkAnswer");u(this,"newAccount");u(this,"recaptchaToken");u(this,"stateToken")}}I([d("login_identifier")],Me.prototype,"loginIdentifier",2);I([d],Me.prototype,"password",2);I([d("login_challenge")],Me.prototype,"challenge",2);I([d("marketing_subscription_status")],Me.prototype,"marketingSubscriptionStatus",2);I([d("mfa_types")],Me.prototype,"mfaTypes",2);I([d("proof_of_work_answer")],Me.prototype,"proofOfWorkAnswer",2);I([d("register_account")],Me.prototype,"newAccount",2);I([d("recaptcha_token")],Me.prototype,"recaptchaToken",2);I([d("state_token",de)],Me.prototype,"stateToken",2);async function Ka(e,t){Z.setUser(void 0,e.loginIdentifier.value+"#"+e.loginIdentifier.type);const n=await Re(new URL("/orchestrator/v2/login",pe),{method:"POST",body:Me.with({...e,loginIdentifier:Mn.with(e.loginIdentifier),proofOfWorkAnswer:tn.with(e.proofOfWorkAnswer)}),signal:t}).catch(he("failed to post login"));switch(n.status){case 200:{const r=await n.json();if(await xe(r,null),r.state_token!==null){const i=Ge.deserialize(r);if(i!=null&&i.stateToken)return i}const s=oe.deserialize(r);if(s!=null&&s.options)return Pa&&Ae.set(St,s.authToken,{secure:!0,httpOnly:!1,sameSite:"lax"}),s;const a=et.deserialize(r);if(a!=null&&a.registerAutoLoginOidcHandoff)return a;break}case 401:return H;case 400:{switch((await n.json()).error_key){case"email":return ht;case"password":return en}break}case 403:{const r=await n.json();switch(r.error_key){case"auth_locked":return qt;case"auth_suspended":return Kt;case"invalid_token":return H;case"bot_detected":return Yt;default:V(r.error_key)}break}case 409:{const r=await n.json();switch(r.error_key){case"exists":return Jo;default:V(r.error_key)}}}throw new Y(n)}var Ya=Object.defineProperty,Xa=Object.getOwnPropertyDescriptor,Fn=(e,t,n,r)=>{for(var s=r>1?void 0:r?Xa(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&Ya(t,n,s),s};class Qo extends A{constructor(){super(...arguments);u(this,"clientName")}}Fn([d("client_name")],Qo.prototype,"clientName",2);class Bn extends A{constructor(){super(...arguments);u(this,"acceptLogout");u(this,"challenge")}}Fn([d("accept_logout")],Bn.prototype,"acceptLogout",2);Fn([d("logout_challenge")],Bn.prototype,"challenge",2);async function Ja(e,t){const n=await Re(new URL("/orchestrator/v1/logout",pe),{method:"POST",body:Bn.with(e),signal:t}).catch(he("failed to post logout"));switch(n.status){case 200:await xe(await n.json(),null);break;case 400:return me}throw new Y(n)}const fe=Ko(e=>e instanceof DOMException&&e.name==="AbortError");function z({children:e,testID:t}){return o.jsx(Eo,{"data-testid":t,children:e})}function ae({children:e,testID:t}){return o.jsx(T,{fontSize:"sm","data-testid":t,children:e})}function _e(){const e=l.useRef(new AbortController);return l.useEffect(()=>{const t=e.current;return()=>t.abort()},[]),e.current}function nn({error:e}){return o.jsxs(o.Fragment,{children:[o.jsx(Eo,{children:"Error!"}),o.jsx(T,{children:e.message})]})}const Qa=""+window.CDN_URL+"assets/checkmark-Dh7NaSwd.svg",Un=l.createContext(null);function ge(){return l.useContext(Un)}function Ne(e,t){lt("auth_authentication_attempt/1.5",e,t)}function Za({challenge:e,oidcHandoff:t,authFlow:n}){const r=C(),s=ge();l.useEffect(()=>{Ne("visit_auth_complete",{device_environment_id:s,challenge:e,failure_reason:null})},[e,s]);const a=l.useCallback(async()=>{Ne("continue_auth_complete",{device_environment_id:s,challenge:e,failure_reason:null}),await Ft(t,null)},[e,t,s]);return o.jsx(ce,{suffix:r("Login successful"),children:o.jsxs(M,{alignSelf:"stretch",alignItems:"stretch",justifyContent:"center",gap:"md",children:[o.jsx(re,{children:o.jsx(ee,{src:Qa,height:"88px",width:"88px",alt:""})}),n=="login"&&o.jsx(re,{children:o.jsx(z,{children:r("You're logged in")})}),n=="register"&&o.jsxs(re,{children:[o.jsx(z,{children:r("Profile created")})," "]}),n=="register"&&o.jsx(re,{children:o.jsx(ae,{children:r("Welcome to Remitly!")})}),n=="password_reset"&&o.jsx(re,{children:o.jsx(z,{children:r("Password changed")})}),o.jsx(R,{testID:"continue-post-auth",size:"lg",onPress:a,title:r("Continue")})]})})}const ei=""+window.CDN_URL+"assets/plus-Dt2379NP.svg";function ti(){var t;const e=Wt();return e instanceof Error?o.jsx(nn,{error:e}):e.payload instanceof Xt?o.jsx(Za,{challenge:e.challenge,oidcHandoff:e.payload.oidcHandoff,authFlow:e.payload.authFlow}):o.jsx(ni,{clientName:e.payload.clientName,userCredential:e.payload.userAddress,scopes:e.payload.scopes,challenge:e.challenge,logoUri:e.payload.logoUri,policyUri:e.payload.policyUri,tosUri:e.payload.tosUri,contractUri:(t=e.payload.contractUri)!=null?t:null})}function gn(e){if(!fe(e))throw e}function ni({clientName:e,userCredential:t,scopes:n,challenge:r,logoUri:s,policyUri:a,tosUri:i,contractUri:p}){const c=C(),f=it(),g=_e(),w=c("Continue"),_=l.useCallback(()=>{_n({consentAction:Ot.Accept,scopes:n,challenge:r},g.signal).catch(gn)},[g.signal,r,n]),b=l.useCallback(()=>{Ae.remove(St),_n({consentAction:Ot.Reject,scopes:n,challenge:r},g.signal).catch(gn)},[g.signal,r,n]),x=l.useCallback(()=>{Ae.remove(St),_n({consentAction:Ot.RejectAndRestartLogin,scopes:n,challenge:r},g.signal).catch(gn)},[g.signal,r,n]);return o.jsxs(o.Fragment,{children:[o.jsxs(Do,{alignSelf:"center",gap:"mdLg",children:[o.jsx(ee,{src:s,objectFit:"contain",h:"icon",alt:""}),o.jsx(ee,{src:ei,h:"20px",w:"19px",alt:""}),o.jsx(ee,{src:zo,h:"icon",aspectRatio:"911/1080",alt:""})]}),o.jsxs(M,{alignItems:"stretch",gap:"md",children:[o.jsx(z,{children:c("Connect {company_name} to your Remitly profile",{company_name:e})}),o.jsx(ae,{children:t}),o.jsx(Gr,{children:n.map(v=>{switch(v){case"openid":case"offline_access":return null;case"auth_token_session":case"session_validation":return o.jsx(Vr,{children:f("This lets {company_name} share your personal information with Remitly making it easier to transfer money. {learn_more}",{company_name:e,learn_more:p&&o.jsx(Ce,{href:p,...ue,children:c("Learn more.")})})},v);default:return Co.notify("unknown consent scope ".concat(v)),null}})}),o.jsx(T,{fontSize:"sm",children:f("By selecting “{accept_consent}“, you consent to {company_name} sharing your data with Remitly in accordance with the {company_name} {terms_of_service} and {privacy_policy}.",{accept_consent:w,company_name:e,privacy_policy:o.jsx(Ce,{href:a,...ue,children:c("privacy policy")}),terms_of_service:o.jsx(Ce,{href:i,...ue,children:c("terms of service")})})}),o.jsx(R,{testID:"accept-consent",onPress:_,title:w}),o.jsx(R,{testID:"reject-consent",buttonType:W.Outline,onPress:b,title:c("Cancel")}),o.jsx(R,{buttonType:W.Link,testID:"reject-consent-and-switch-account",title:c("Use a different profile"),onPress:x})]})]})}const Zo=""+window.CDN_URL+"assets/not-found-DPGkbQ7i.png";function er(){const e=C();return o.jsx(ce,{suffix:e("Not Found"),children:o.jsxs(M,{gap:"mdLg",children:[o.jsx(ee,{src:Zo,width:"240px",height:"161px",alt:""}),o.jsx(z,{children:e("Not Found")}),o.jsx(T,{children:e("We weren't able to locate what you're looking for.")})]})})}function oi(){const e=qr();return Kr(e)&&e.status===404?o.jsx(er,{}):o.jsx(tr,{})}function tr(){const e=C();return o.jsx(ce,{suffix:e("Something Went Wrong"),children:o.jsxs(M,{gap:"md",alignItems:"stretch",children:[o.jsx(z,{children:e("Something Went Wrong")}),o.jsx(T,{children:e("We aren’t able to complete your request right now, but we’re working to resolve the issue.")}),o.jsx(R,{title:e("Start Over"),onPress:l.useCallback(()=>window.location.reload(),[])})]})})}function ri(){const e=C();return o.jsx(ce,{suffix:e("Not Found"),children:o.jsxs(M,{gap:"mdLg",children:[o.jsx(ee,{src:Zo,width:"240px",height:"161px",alt:""}),o.jsx(z,{children:e("This link has expired")})]})})}function si(){const[e]=Io(),t=e.get("error"),n=e.get("error_description"),r=e.get("error_hint"),s=C();return o.jsx(ce,{suffix:s("Access Blocked"),children:o.jsxs(M,{gap:"md",alignSelf:"stretch",alignItems:"start",children:[o.jsx(z,{children:s("Access Blocked")}),o.jsxs(T,{children:[o.jsxs(T,{as:"b",children:[s("Error Code"),": "]}),t]}),o.jsxs(T,{children:[o.jsxs(T,{as:"b",children:[s("Description"),": "]}),n]}),o.jsx(T,{children:r})]})})}function ai(e,t){const n=To(),r=Ht(),s=l.useMemo(()=>{var i;try{return e((i=r.state)==null?void 0:i.useHistoryState)}catch(p){return Z.notify(p),null}},[e,r.state]),a=l.useCallback(i=>{var p;n(r,{state:{...r.state,useHistoryState:t(i)},replace:!!((p=r.state)!=null&&p.useHistoryState)})},[r,n,t]);return[s,a]}function ii({onClose:e,leastDestructiveRef:t}){const n=C();return o.jsx(ke,{testID:"api-error-modal",body:n("We're sorry, something is not working right. Please try again later."),primaryButton:{leastDestructiveRef:t,testID:"api-error-modal-close",title:n("Close"),onPress:e}})}function li({leastDestructiveRef:e,onClose:t,openPasswordReset:n}){const r=C();return o.jsx(ke,{testID:"auth-locked-error-modal",title:r("Too many attempts"),body:o.jsxs(o.Fragment,{children:[r("We locked your profile for security."),o.jsx("br",{}),r("Change your password to sign in.")]}),primaryButton:{leastDestructiveRef:null,testID:"auth-locked-error-modal-change-password",title:r("Change Password"),onPress(){t(),n()}},secondaryButton:{leastDestructiveRef:null,testID:"auth-locked-error-modal-get-help",title:r("Get Help"),href:ba,hrefAttrs:ue},tertiaryButton:{leastDestructiveRef:e,testID:"auth-locked-error-modal-close",title:r("Close"),onPress:t}})}function ci({leastDestructiveRef:e,onClose:t}){const n=C(),r=o.jsx(T,{"data-testid":"auth-suspended-model-body",children:n("If you think this was an error, answer a few questions to help us understand if we can reactivate it.")});return o.jsx(ke,{testID:"auth-suspended-error-modal",title:n("Your profile is suspended"),body:r,primaryButton:{leastDestructiveRef:null,testID:"auth-suspended-error-modal-get-help",title:n("Get Help"),href:ya,hrefAttrs:ue},secondaryButton:{leastDestructiveRef:e,testID:"auth-suspended-error-modal-close",title:n("Close"),onPress:t}})}function ui({leastDestructiveRef:e,onClose:t}){const n=C();return o.jsx(ke,{testID:"bot-detected-error-modal",body:n("We couldn’t complete this request. Wait a few minutes and then try again."),primaryButton:{leastDestructiveRef:e,testID:"bot-detected-error-modal-close",title:n("Close"),onPress:t},secondaryButton:{leastDestructiveRef:null,testID:"bot-detected-error-modal-get-help",title:n("Get Help"),href:ja,hrefAttrs:ue}})}function tt(e,t){lt("app_user_interaction/1.1",e,t)}function di({onClose:e,openPasswordReset:t,openRegister:n,leastDestructiveRef:r,rpDeviceEnvironmentId:s}){const a=C(),i="click",p=l.useCallback(()=>{tt(i,{device_environment_id:s,screen:"one auth sign in",target:"sign up",context:"We can't find your profile modal"}),n()},[n,s]);return o.jsx(ke,{testID:"login-error-modal",title:a("We can't find your profile"),body:a("Your email address or password are incorrect."),primaryButton:{leastDestructiveRef:r,testID:"login-error-modal-close",title:a("Try Again"),onPress:e},secondaryButton:{leastDestructiveRef:null,testID:"login-error-modal-reset-password",title:a("Change Password"),onPress:()=>{e(),t()}},tertiaryButton:{leastDestructiveRef:null,testID:"login-error-modal-join-now",title:a("Join Now"),onPress:()=>{e(),p()}}})}function fi({onClose:e,onLogin:t,leastDestructiveRef:n,rpDeviceEnvironmentId:r}){const s=C(),a="click",i=l.useCallback(()=>{tt(a,{device_environment_id:r,screen:"one auth sign up",target:"sign in",context:"Welcome back modal"}),t()},[t,r]);return o.jsx(ke,{testID:"profile-exist-error-modal",title:s("Welcome back"),body:s("You already have a Remitly profile"),primaryButton:{leastDestructiveRef:null,testID:"profile-exist-error-modal-sign-in",title:s("Sign In"),onPress:i},secondaryButton:{leastDestructiveRef:n,testID:"profile-exist-error-modal-close",title:s("Close"),onPress:e}})}function pi({leastDestructiveRef:e,onClose:t}){const n=C();return o.jsx(ke,{testID:"rate-limit-error-modal",body:n("Try again in a few minutes"),primaryButton:{leastDestructiveRef:e,testID:"rate-limit-error-modal-close",title:n("Close"),onPress:t}})}function mi({onClose:e,openPasswordReset:t,leastDestructiveRef:n,rpDeviceEnvironmentId:r}){const s=C(),a="click",i=l.useCallback(()=>{tt(a,{device_environment_id:r,screen:"one auth sign up",target:"password reset",context:"Unable to create a profile modal"}),e(),t()},[e,t,r]);return o.jsx(ke,{testID:"login-error-modal",title:s("Unable to create a profile"),body:s("We are unable to create a new profile with the information you provided."),primaryButton:{leastDestructiveRef:n,testID:"signup-error-modal-try-again",title:s("Try Again"),onPress:e},secondaryButton:{leastDestructiveRef:null,testID:"signup-error-modal-reset-password",title:s("Change Password"),onPress:i}})}const hi=/.+@.+\..+/i,_i=/^[\x00-\x7F]+@.+\..+/i;function gi(e){return hi.test(e)}function wi(e){return _i.test(e)}function on(){const e=l.useRef(new Map),t=l.useMemo(()=>({register(r){const s=Symbol();return e.current.set(s,r),s},deregister(r){e.current.delete(r)}}),[]);return{validate:l.useCallback(async()=>{const r=Array.from(e.current.values()).map(a=>a());return!(await Promise.all(r)).includes(!1)},[]),validationController:t}}function vt(e,t,n){const[r,s]=l.useState(e),[a,i]=l.useState(null),p=l.useRef(),c=l.useCallback(async(g,w)=>{const _=await t(g);p.current==w&&i(_)},[t]),f=l.useCallback(g=>{if(a){const w=Symbol();p.current=w,typeof g=="function"?s(_=>{const b=g(_);return c(b,w),b}):(s(g),c(g,w))}else s(g)},[a,c]);return l.useEffect(()=>{const g=n.register(async()=>{const w=await t(r);return i(w),!w});return()=>n.deregister(g)},[n,t,r]),l.useEffect(()=>{a&&(async()=>{const g=Symbol();p.current=g;const w=await t(r);p.current==g&&i(w)})()},[t]),[r,f,a]}var xi=Object.defineProperty,bi=Object.getOwnPropertyDescriptor,nr=(e,t,n,r)=>{for(var s=r>1?void 0:r?bi(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&xi(t,n,s),s};class Nn extends A{constructor(){super(...arguments);u(this,"confirm");u(this,"challenge")}}nr([d("confirm")],Nn.prototype,"confirm",2);nr([d("login_challenge")],Nn.prototype,"challenge",2);async function yi(e,t,n){const r=await Re(new URL("/orchestrator/v1/login/confirm_account",pe),{method:"POST",body:Nn.with(e),signal:t}).catch(he("failed to confirm account"));switch(r.status){case 200:await xe(await r.json(),n);break;case 401:return H}throw new Y(r)}const Qe="ABORTED",jt="api_error",Ct="auth_error",or="auth_factor_wrong",vi="AUTH_LOCKED",ji="AUTH_SUSPENDED",Ci="bot_detected",rr="INTERNAL_SERVER_ERROR",Pi="invalid_email",so="LOGIN_CHALLENGE_EXPIRED",ki="manual_recaptcha",Ei="MFA_CODE_WRONG",sr="MFA_RATE_LIMITED",ao="oauth_error",$n="too_many_requests",nt="validation_error";function Di({challenge:e,email:t,onError:n}){const r=C(),s=ge(),a=_e();l.useEffect(()=>{Ne("visit_confirm_account",{device_environment_id:s,challenge:e,failure_reason:null})},[e,s]);const i=r("Confirm"),p=l.useCallback(async w=>{const _={device_environment_id:s,challenge:e,failure_reason:null};Ne(w===!0?"submit_confirm_account_request":"use_different_profile_confirm_account",_);try{await yi({confirm:w,challenge:e},a.signal,()=>{Ne("confirm_account_response",_)})}catch(b){if(fe(b)){_.failure_reason=Qe;return}throw _.failure_reason=rr,Ne("confirm_account_response",_),n(me),b}},[a.signal,e,n,s]),c=l.useCallback(()=>{p(!0)},[p]),f=l.useCallback(()=>{p(!1)},[p]),g=r("Confirm your account");return o.jsxs(ce,{suffix:g,children:[o.jsxs(M,{alignItems:"stretch",gap:"md",children:[o.jsx(z,{children:g}),o.jsx(ae,{testID:"email-hint",children:t}),o.jsx(R,{testID:"confirm-account",onPress:c,title:i})]}),o.jsx(R,{testID:"switch-account",buttonType:W.Link,title:r("Use a different profile"),onPress:f})]})}var Ii=Object.defineProperty,Ti=Object.getOwnPropertyDescriptor,ar=(e,t,n,r)=>{for(var s=r>1?void 0:r?Ti(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&Ii(t,n,s),s};class ir extends A{constructor(){super(...arguments);u(this,"loginChallenge");u(this,"marketingSubscriptionStatus")}}ar([d("login_challenge")],ir.prototype,"loginChallenge",2);ar([d("marketing_subscription_status")],ir.prototype,"marketingSubscriptionStatus",2);async function Li(e,t){var s;const n={accept:"application/json","content-type":"application/json"},r=await fetch(new URL("/orchestrator/v1/account/external/oauth/apple?"+new URLSearchParams({login_challenge:(s=e.loginChallenge)!=null?s:"",marketing_subscription_status:e.marketingSubscriptionStatus?"true":"false"}).toString(),pe),{headers:n,signal:t}).catch(he("failed to get initiate apple flow"));switch(r.status){case 200:{const a=await r.json();await xe(a,null);break}case 400:return H}throw new Y(r)}function io({challenge:e,marketingSubscriptionStatus:t}){const n=C(),r=_e(),s=l.useCallback(async()=>{await Li({loginChallenge:e,marketingSubscriptionStatus:t!=null?t:!1},r.signal)},[r.signal,e,t]);return o.jsx(R,{leftIcon:o.jsx(Lo,{viewBox:"-1.5 0 20 20",boxSize:5,children:o.jsx("path",{d:"M11.57 3.193c.73-.845 1.221-2.022 1.087-3.193-1.05.04-2.322.671-3.075 1.515-.677.749-1.267 1.946-1.108 3.094 1.172.087 2.368-.57 3.097-1.416m2.628 7.432c.03 3.027 2.77 4.034 2.801 4.047-.022.07-.438 1.435-1.444 2.845-.87 1.218-1.774 2.43-3.196 2.457-1.398.025-1.848-.794-3.447-.794-1.597 0-2.097.768-3.42.819-1.373.049-2.42-1.318-3.296-2.532C.403 14.984-.967 10.45.873 7.39c.915-1.52 2.548-2.482 4.321-2.506 1.348-.025 2.621.869 3.445.869.825 0 2.372-1.075 3.998-.917.68.027 2.591.263 3.818 1.984-.1.059-2.28 1.275-2.256 3.805"})}),buttonType:W.Social,testID:"apple-btn",title:n("Continue with Apple"),onPress:s})}var Ai=Object.defineProperty,Ri=Object.getOwnPropertyDescriptor,lr=(e,t,n,r)=>{for(var s=r>1?void 0:r?Ri(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&Ai(t,n,s),s};class cr extends A{constructor(){super(...arguments);u(this,"loginChallenge");u(this,"marketingSubscriptionStatus")}}lr([d("login_challenge")],cr.prototype,"loginChallenge",2);lr([d("marketing_subscription_status")],cr.prototype,"marketingSubscriptionStatus",2);async function Oi(e,t){var s;const n={accept:"application/json","content-type":"application/json"},r=await fetch(new URL("/orchestrator/v1/account/external/oauth/google?"+new URLSearchParams({login_challenge:(s=e.loginChallenge)!=null?s:"",marketing_subscription_status:e.marketingSubscriptionStatus?"true":"false"}).toString(),pe),{headers:n,signal:t}).catch(he("failed to get initiate google flow"));switch(r.status){case 200:{const a=await r.json();await xe(a,null);break}case 400:return H}throw new Y(r)}function lo({challenge:e,marketingSubscriptionStatus:t}){const n=C(),r=_e(),s=l.useCallback(async()=>{await Oi({loginChallenge:e,marketingSubscriptionStatus:t!=null?t:!1},r.signal)},[r.signal,e,t]);return o.jsx(o.Fragment,{children:o.jsx(R,{leftIcon:o.jsxs(Lo,{viewBox:"-1.5 0 262 262",boxSize:5,children:[o.jsx("path",{fill:"#4285F4",d:"M255.878 133.451c0-10.734-.871-18.567-2.756-26.69H130.55v48.448h71.947c-1.45 12.04-9.283 30.172-26.69 42.356l-.244 1.622 38.755 30.023 2.685.268c24.659-22.774 38.875-56.282 38.875-96.027"}),o.jsx("path",{fill:"#34A853",d:"M130.55 261.1c35.248 0 64.839-11.605 86.453-31.622l-41.196-31.913c-11.024 7.688-25.82 13.055-45.257 13.055-34.523 0-63.824-22.773-74.269-54.25l-1.531.13-40.298 31.187-.527 1.465C35.393 231.798 79.49 261.1 130.55 261.1"}),o.jsx("path",{fill:"#FBBC05",d:"M56.281 156.37c-2.756-8.123-4.351-16.827-4.351-25.82 0-8.994 1.595-17.697 4.206-25.82l-.073-1.73L15.26 71.312l-1.335.635C5.077 89.644 0 109.517 0 130.55s5.077 40.905 13.925 58.602l42.356-32.782"}),o.jsx("path",{fill:"#EB4335",d:"M130.55 50.479c24.514 0 41.05 10.589 50.479 19.438l36.844-35.974C195.245 12.91 165.798 0 130.55 0 79.49 0 35.393 29.301 13.925 71.947l42.211 32.783c10.59-31.477 39.891-54.251 74.414-54.251"})]}),buttonType:W.Social,testID:"google-btn",title:n("Continue with Google"),onPress:s})})}const zn=l.createContext(null);function rn(){return l.useContext(zn)}const Wn=l.createContext(null);function sn(){return l.useContext(Wn)}var Si=Object.defineProperty,Mi=Object.getOwnPropertyDescriptor,Hn=(e,t,n,r)=>{for(var s=r>1?void 0:r?Mi(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&Si(t,n,s),s},Pn=(e=>(e.Login="login",e.Register="register",e))(Pn||{});class an extends A{constructor(){super(...arguments);u(this,"difficulty");u(this,"value");u(this,"expiresAfterMillis")}}Hn([d("difficulty")],an.prototype,"difficulty",2);Hn([d("value")],an.prototype,"value",2);Hn([d("expires_after_millis")],an.prototype,"expiresAfterMillis",2);async function Fi(e,t){const n=await fetch(new URL("/orchestrator/v1/proof_of_work_challenge/".concat(e),pe),{headers:{accept:"application/json"},signal:t}).catch(he("failed to get proof of work challenge"));if(n.status!=200)throw new Y(n);const r=an.deserialize(await n.json());if(r!=null&&r.value){const s=new Date,a=new Date(s.getTime()+r.expiresAfterMillis);return{hash:r.value,difficulty:r.difficulty,expiration:a}}throw new Y(n)}function ur({value:e,error:t,onChange:n,hidden:r}){const s=C();return o.jsxs(rt,{isInvalid:!!t,id:"email",children:[o.jsx(gt,{hidden:r,children:s("Email Address")}),o.jsx(st,{"data-testid":"email",type:"email",placeholder:"abc@example.com",value:e,onChange:l.useCallback(a=>n(a.target.value),[n]),autoFocus:!0,autoComplete:"username",autoCapitalize:"none",inputMode:"email",hidden:r}),o.jsx(at,{"data-testid":"text-input-error-email",children:t})]})}function Bi({value:e}){return o.jsx("input",{style:{display:"none"},"aria-hidden":"true",type:"email","data-testid":"email",placeholder:"abc@example.com",value:e,autoComplete:"username",id:"email",readOnly:!0})}function ut({testID:e,id:t,children:n,onSubmit:r}){const s=l.useCallback(a=>{a.preventDefault(),r()},[r]);return o.jsx("form",{id:t,"data-testid":e,onSubmit:s,noValidate:!0,children:n})}function co(e){return!(e==null||e.length<8)}const Ui=""+window.CDN_URL+"assets/eye-crossed-BnStAZsK.svg",Ni=""+window.CDN_URL+"assets/eye-BrsMgA40.svg";function dr(e,t){const n=C(),[r,s]=l.useState(null),[a,i]=l.useState(null),p=l.useCallback(function(b){return co(b)&&r!=en?null:co(b)?n("Please enter a valid password"):n("Please enter at least 8 characters")},[r,n]),[c,f,g]=vt("",p,e),w=l.useCallback(_=>{f(_),s(null)},[f]);return $e.useEffect(()=>{r&&t()},[r,t]),$e.useEffect(()=>{p(c)?i(n("Password should be at least 8 characters")):i(null)},[n,c,p]),{password:c,passwordError:g,setPassword:w,setPasswordExternalError:s,passwordHelperText:a}}const wn=24;function $i(){const[e,t]=l.useState(!1),n=l.useCallback(r=>{var s;t((s=r.getModifierState)==null?void 0:s.call(r,"CapsLock"))},[]);return l.useEffect(()=>(window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}),[n]),e}function fr({label:e,value:t,newPassword:n,error:r,onChange:s,validationController:a,autoFocus:i,passwordHelperText:p}){const[c,f]=l.useState(!0),g=l.useCallback(()=>{f(!c)},[c,f]),w=$i(),[_,b]=l.useState(!1),x=C();return o.jsxs(o.Fragment,{children:[o.jsxs(rt,{isInvalid:!!r,id:n?"new-password":"current-password",children:[o.jsx(gt,{children:e}),o.jsxs(Yr,{children:[o.jsx(st,{"data-testid":"password",type:c?"password":"text",value:t,onChange:l.useCallback(v=>s(v.target.value),[s]),id:n?"new-password":"current-password",autoComplete:n?"new-password":"current-password",autoCapitalize:"none",autoFocus:i,minLength:8,onFocus:l.useCallback(()=>{b(!0)},[]),onBlur:l.useCallback(()=>{b(!1)},[])}),o.jsx(Xr,{mx:"md",w:"".concat(wn,"px"),children:o.jsx(Jr,{"aria-label":c?"Show password":"Hide password",onClick:g,variant:"unstyled",display:"flex","data-testid":"toggle-password-visibility",border:"none",mb:c?void 0:"2px",icon:o.jsx(ee,{h:"".concat(wn,"px"),w:"".concat(wn,"px"),src:c?Ni:Ui,alt:x(c?"Show password":"Hide password")})})})]}),n&&p?o.jsx(Jn,{children:p}):null,w&&_&&c?o.jsx(Jn,{children:x("Caps Lock is on")}):null,o.jsx(at,{"data-testid":"text-input-error-password",children:r})]}),n&&o.jsx(zi,{password:t,showConfPasswordError:r==null,secureEntry:c,validationController:a})]})}function zi({password:e,showConfPasswordError:t,secureEntry:n,validationController:r}){const s=C(),[a,i,p]=vt("",l.useCallback(function(f){if(!t)return null;if(!e)return s("Please enter a valid password");if(e!==f)return s("Your passwords do not match")},[s,e,t]),r);return o.jsxs(rt,{isInvalid:!!p,children:[o.jsx(gt,{children:s("Confirm Password")}),o.jsx(st,{"data-testid":"conf-password",type:n?"password":"text",value:a,onChange:l.useCallback(c=>i(c.target.value),[i]),autoComplete:"new-password",autoCapitalize:"none"}),o.jsx(at,{"data-testid":"text-input-error-conf-password",children:p})]})}function Wi({onClose:e,onLogin:t,leastDestructiveRef:n,rpDeviceEnvironmentId:r,registerResponse:s}){const a=C(),i="click",p=l.useCallback(()=>{tt(i,{device_environment_id:r,screen:"one auth sign up",target:"sign in",context:"Welcome back modal"}),t(s)},[t,s,r]),c=l.useCallback(()=>{e(s)},[e,s]);return o.jsx(ke,{testID:"profile-exist-error-modal",title:a("Welcome back"),body:a("You already have a Remitly profile"),primaryButton:{leastDestructiveRef:null,testID:"profile-exist-error-modal-sign-in",title:a("Sign In"),onPress:p},secondaryButton:{leastDestructiveRef:n,testID:"profile-exist-error-modal-close",title:a("Close"),onPress:c}})}const pr="Remitly Native (preprod)",mr="Remitly Native",Hi=1e3*1,Gi=1e3*10,uo=new Error("grecaptcha timeout");async function Gn(e,t){const n=K.RECAPTCHA_SITE_KEY;if(!n)return null;typeof grecaptcha>"u"&&(window.grecaptcha={ready(r){var a,i;const s="___grecaptcha_cfg";window[s]=(a=window[s])!=null?a:{},(window[s].fns=(i=window[s].fns)!=null?i:[]).push(r)}});try{await Promise.race([new Promise((r,s)=>{let a=!1;function i(){a=!0,t.removeEventListener("abort",i),s(new DOMException(void 0,"AbortError"))}t.addEventListener("abort",i),grecaptcha.ready(()=>{t.removeEventListener("abort",i),!a&&r()})}),new Promise((r,s)=>setTimeout(s,Hi,uo))])}catch(r){if(r===uo)return console.warn("grecaptcha ready timed out"),null;throw r}if(t.aborted)throw t.reason;return await Promise.race([grecaptcha.execute(n,{action:e}),new Promise(r=>setTimeout(()=>{console.warn("grecaptcha execute timed out"),r(null)},Gi)),new Promise((r,s)=>{function a(){t.removeEventListener("abort",a),s(new DOMException(void 0,"AbortError"))}t.addEventListener("abort",a)})])}function hr({setManualRecaptchaToken:e,setRecaptchaWidgetId:t}){const n=l.useCallback(r=>{if(r){if(typeof grecaptcha>"u"||!grecaptcha)throw new Error("grecaptcha not found");if(!K.RECAPTCHA_SITE_KEY_V2)throw new Error("RECAPTCHA_SITE_KEY_V2 not found");const s=grecaptcha.render(r,{sitekey:K.RECAPTCHA_SITE_KEY_V2,callback:a=>{e(a)}});t(s)}},[e,t]);return o.jsx(re,{children:o.jsx("div",{"data-testid":"manual-recaptcha-iframe",ref:n})})}function Bt(e){if(e!=null){if(typeof grecaptcha>"u"||!grecaptcha)throw new Error("grecaptcha not found");grecaptcha.reset(e)}}function Vi({country:e,submitTitle:t}){const n=C(),r=it(),s=l.useMemo(()=>{const a={join_now:t,privacy_policy:o.jsx(Ce,{href:oo(e),...ue,children:n("Privacy Policy")}),user_agreement:o.jsx(Ce,{href:ro(e),...ue,children:n("User Agreement")}),esign_disclosure_notice:o.jsx(Ce,{href:Ca(e),...ue,children:n("E-sign Disclosure and Consent Notice")})};switch(e){case"US":return r("By selecting “{join_now}” you agree to Remitly's {privacy_policy}, {user_agreement}, and to receive communications according to the {esign_disclosure_notice}.",a);default:return r("By selecting “{join_now}” you agree to Remitly's {privacy_policy} and {user_agreement}.",a)}},[e,n,r,t]);return o.jsxs(o.Fragment,{children:[o.jsx(T,{fontSize:"sm",children:s}),e=="AE"?o.jsxs(T,{fontSize:"sm",children:["بالنقر على ”الانضمام الآن“، فإنك توافق على"," ",o.jsx(Ce,{href:ro(e),children:"اتفاقية المستخدم"})," &"," ",o.jsx(Ce,{href:oo(e),children:"سياسة الخصوصية"})]}):null]})}function qi(e){const[t,n]=l.useState(new Promise(()=>{})),[r,s]=l.useState(null),a=l.useCallback(i=>{try{n((async()=>{const p=await Fi(e,i);return s(p.expiration),Qr.solveNonBlocking(p,window.requestIdleCallback)})())}catch(p){n(Promise.reject(p))}},[n,e]);return l.useEffect(()=>{const i=new AbortController;if(r){const p=r.getTime()-Date.now(),c=Math.max(p-2e3,0),f=setTimeout(()=>a(i.signal),c);return()=>{i.abort(),clearTimeout(f)}}return()=>i.abort()},[r,a]),l.useEffect(()=>{const i=new AbortController;return a(i.signal),()=>i.abort()},[a]),l.useEffect(()=>()=>{t.catch(i=>{if(!fe(i))throw i})}),[t,a]}function Ki({challenge:e,country:t,email:n,emailError:r,newAccount:s,onAuth:a,onError:i,setEmail:p,validate:c,validationController:f,marketingSubscriptionComponent:g,marketingSubscriptionStatus:w,accountLinking:_,historyState:b,clientName:x}){var pt,Te;const v=_e(),E=C(),P=it(),[L,m]=qi(s?Pn.Register:Pn.Login),{password:h,setPassword:D,passwordError:k,setPasswordExternalError:y,passwordHelperText:X}=dr(f,c),$=Je(),[B,N]=l.useState(null),[F,O]=l.useState(null),U=ge(),se=Vt(),ye=l.useCallback(async J=>{J instanceof et?await Ft(J.restartOidcHandoff,null):J instanceof oe?(m(v.signal),se.hide()):V()},[se,m,v]),ve=l.useCallback(async J=>{if(se.hide(),J instanceof et)await Ft(J.registerAutoLoginOidcHandoff,null);else if(J instanceof oe){const we=ne.with({mfaRequiredResponse:J,mfaGeneratedResponse:null});a(we)}else V()},[se,a]),Fe=l.useCallback(J=>{se.show(we=>o.jsx(Wi,{leastDestructiveRef:we,rpDeviceEnvironmentId:U,onClose:ye,onLogin:ve,registerResponse:J}))},[ve,ye,se,U]),Ze=l.useCallback(async()=>{var J;if(!await c()){Bt(B),O(null);return}$(!0);try{const we=x==pr||x==mr?"post_login_native":"post_login";let Ke;((J=b==null?void 0:b.requiredAuthFactor)==null?void 0:J[0])==="manual_recaptcha"?Ke=F:Ke=await Gn(we,v.signal);const mt=await L,te=await Ka({loginIdentifier:{value:n,type:"email"},password:h,challenge:e,marketingSubscriptionStatus:w,proofOfWorkAnswer:{challenge:mt.challenge.hash,nonce1:mt.nonce1,nonce2:mt.nonce2},mfaTypes:["sms","email","voice_call","push"],newAccount:s,recaptchaToken:Ke,stateToken:b},v.signal);if(te instanceof oe&&(te!=null&&te.registerAutoLogin)||te instanceof et)Fe(te);else if(te instanceof oe){const Et=ne.with({mfaRequiredResponse:te,mfaGeneratedResponse:null});a(Et)}else te instanceof Ge?a(te.stateToken):(te==en?y(te):i(te),m(v.signal))}catch(we){if(fe(we))return;try{m(v.signal)}catch(Ke){if(fe(Ke))return}throw i(me),we}finally{Bt(B),O(null),$(!1)}},[c,$,B,b,L,n,h,e,w,s,v.signal,F,Fe,a,m,y,i,x]),G=E(_?"Confirm":s?"Join now":"Sign In"),Ie=s?"register":"login",dn=l.useMemo(()=>{const J={get_help:o.jsx(Ce,{href:"http://www.remitly.com/help",...ue,children:E("We're here to help.")})};return P("Problems logging in? {get_help}",J)},[E,P]);return o.jsx(ut,{onSubmit:Ze,id:Ie,children:o.jsxs(M,{alignItems:"stretch",gap:"md",children:[o.jsx(ur,{value:n,onChange:p,error:r,hidden:_}),o.jsx(fr,{label:E("Password"),value:h,newPassword:s,onChange:D,error:k,validationController:f,autoFocus:!1,passwordHelperText:X}),s&&o.jsx(Vi,{country:t,submitTitle:G}),s&&g,((pt=b==null?void 0:b.requiredAuthFactor)==null?void 0:pt[0])==="manual_recaptcha"&&o.jsx(hr,{setManualRecaptchaToken:O,setRecaptchaWidgetId:N}),o.jsx(R,{testID:"log-in",title:G,submits:!0,disabled:((Te=b==null?void 0:b.requiredAuthFactor)==null?void 0:Te[0])==="manual_recaptcha"&&F==null}),_&&o.jsx(T,{align:"center",children:dn})]})},Ie)}function _r({onClose:e,startOver:t,leastDestructiveRef:n}){const r=C();return o.jsx(ke,{testID:"auth-expired-error-modal",title:r("Your session expired"),body:o.jsx(T,{"data-testid":"auth-expired-model-body",children:r("For security, we end sessions after 30 minutes.")}),primaryButton:{leastDestructiveRef:null,testID:"auth-expired-error-modal-try-again",title:r("Try Again"),onPress(){e(),t()}},secondaryButton:{leastDestructiveRef:n,testID:"auth-expired-error-modal-close",title:r("Close"),onPress:e}})}function Yi({onClose:e,leastDestructiveRef:t}){const n=C();return o.jsx(ke,{testID:"mfa-rate-limit-error-modal",title:n("Too many attempts"),body:n("Try again in 3 minutes"),primaryButton:{leastDestructiveRef:t,testID:"mfa-rate-limit-error-modal-close",title:n("Close"),onPress:e}})}function ie(e,{mfa_type:t,...n}){let r=t==null?void 0:t.toUpperCase();r||(Z.notify(new Error("missing MFA type for UEL")),r="<unknown>");const s={mfa_type:r,...n};lt("auth_mfa_client_flow/1.2",e,s)}const je="<unknown>",Xi={app_build:je,app_version:K.APP_VERSION,browser_engine_name:je,browser_engine_version:je,browser_name:je,browser_version:je,device_locale:Oe(),device_make:je,device_model:je,device_vendor_id:je,device_model_version:je,os:je,os_version:je,screen_height:screen.height,screen_scale_factor:devicePixelRatio||0,screen_width:screen.width},gr={send_country:"XXX",receive_country:"XXX"},wr={session_id:"<deprecated>"},xr={metrics_id:"<deprecated>"};function ot(e,{mfa_type:t,...n}){let r=t==null?void 0:t.toUpperCase();r||(Z.notify(new Error("missing MFA type for UEL")),r="<unknown>");const s={...xr,...Xi,...gr,...wr,mfa_type:r,...n};lt("mfa_flow/1.1",e,s)}function Ji({mfaType:e,mfaOptions:t,source:n,challenge:r}){const s=C(),a=ge(),i=sn(),p=rn(),c=l.useCallback(()=>{ot("request_help",{failure_reason:null,mfa_type:e,device_environment_id:a,user_id:i}),ie("request_help",{mfa_type:e,mfa_options:Cn(t),device_environment_id:a,customer_public_id:i,oidc_client_id:p,resource_id:null,source:n,failure_reason:null,remember_device:null,challenge:r})},[t,e,a,i,p,n,r]);return o.jsx(R,{title:s("Get help"),buttonType:W.Link,href:Go,hrefAttrs:ue,onPress:c})}function Qi({option:e}){const t=C(),n=it();return l.useMemo(()=>{if(e instanceof wt)return o.jsx(ae,{testID:"hint-email-sms-option",children:n("Get verified with a text sent to the mobile number **ending in {last_four}**",{last_four:e.lastFour})});if(e instanceof xt)return o.jsx(ae,{testID:"hint-voice-mfa-option",children:n("Get verified by getting a call on your phone number **ending in {last_four}**",{last_four:e.lastFour})});if(e instanceof ct)return o.jsx(ae,{testID:"hint-email-mfa-option",children:n("Get verified with an email sent to **{email}**",{email:e.hint})});if(e==Xe)return o.jsx(ae,{testID:"hint-push-mfa-option",children:t("Get verified with a notification to your devices")});V()},[e,n,t])}const Zi=""+window.CDN_URL+"assets/email-CAke6J-K.svg",el=""+window.CDN_URL+"assets/phone-call-BgRi5wFe.svg",tl=""+window.CDN_URL+"assets/phone-C_ECSSu5.svg",nl=""+window.CDN_URL+"assets/text-bubble-C7j-mWfK.svg";function ol({isOpen:e,onClose:t,options:n,onChange:r}){const s=C();return o.jsx(o.Fragment,{children:o.jsxs(yo,{placement:"bottom",isOpen:e,onClose:t,variant:"bottomDrawer",children:[o.jsx(In,{}),o.jsx(vo,{children:o.jsxs(Ut,{borderTopRadius:"base",backgroundColor:"white",width:"100%",maxW:"500px",alignSelf:"center",position:"relative",children:[o.jsx(Zr,{"data-testid":"close-choose-mfa"}),o.jsx(wo,{children:s("How would you like to get verified?")}),o.jsx(bn,{children:o.jsx(M,{gap:"md",alignItems:"stretch",children:n.map(a=>{const i=Ue(a);return o.jsx(rl,{testId:"mfa-choice-".concat(i),option:a,onPress:()=>{r(a)}},i)})})}),o.jsx(xo,{justifyContent:"stretch",display:"flex",children:o.jsx(R,{title:s("Get Help"),size:"md",buttonType:W.Outline,href:Go,hrefAttrs:ue})})]})})]})})}function rl(e){const t=C();if(e.option instanceof wt)return o.jsx(Dt,{testId:e.testId,img:nl,title:t("Text me"),subtitle:t("ending in {last_four}",{last_four:e.option.lastFour}),onPress:e.onPress});if(e.option instanceof xt)return o.jsx(Dt,{testId:e.testId,img:el,title:t("Call me"),subtitle:t("ending in {last_four}",{last_four:e.option.lastFour}),onPress:e.onPress});if(e.option instanceof ct)return o.jsx(Dt,{testId:e.testId,img:Zi,title:t("Email me"),subtitle:e.option.hint,onPress:e.onPress});if(e.option==Xe)return o.jsx(Dt,{testId:e.testId,img:tl,title:t("Send notification"),subtitle:t("To your previous device"),onPress:e.onPress});V(e.option)}function Dt(e){return o.jsx("button",{onClick:e.onPress,"data-testid":e.testId,children:o.jsxs(Do,{gap:"md",children:[o.jsx(re,{children:o.jsx(ee,{src:e.img,height:"iconModal",width:"iconModal",alt:""})}),o.jsxs(Ut,{textAlign:"start",children:[o.jsx(T,{fontWeight:"bold",children:e.title}),o.jsx(T,{children:e.subtitle})]})]})})}const sl=""+window.CDN_URL+"assets/generate-mfa-Cr97nl7r.svg";var al=Object.defineProperty,il=Object.getOwnPropertyDescriptor,Vn=(e,t,n,r)=>{for(var s=r>1?void 0:r?il(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&al(t,n,s),s};class ln extends A{constructor(){super(...arguments);u(this,"challenge");u(this,"authToken");u(this,"stateToken")}}Vn([d("login_challenge")],ln.prototype,"challenge",2);Vn([d("auth_token")],ln.prototype,"authToken",2);Vn([d("state_token",de)],ln.prototype,"stateToken",2);const br=Symbol("push_mfa_requires_completion");async function ll(e,t){const n=await Re(new URL("/orchestrator/v1/mfa/confirm",pe),{method:"POST",body:ln.with(e),signal:t}).catch(he("failed to confirm MFA"));switch(n.status){case 200:throw await xe(await n.json(),null),new Y(n);case 202:return br;case 401:return H;default:throw new Y(n)}}const cl=""+window.CDN_URL+"assets/mfa-code-sent-kd6VN8rF.svg";var ul=Object.defineProperty,dl=Object.getOwnPropertyDescriptor,dt=(e,t,n,r)=>{for(var s=r>1?void 0:r?dl(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&ul(t,n,s),s};class ft extends A{constructor(){super(...arguments);u(this,"challenge");u(this,"authToken");u(this,"code");u(this,"rememberDevice");u(this,"stateToken")}}dt([d("login_challenge")],ft.prototype,"challenge",2);dt([d("auth_token")],ft.prototype,"authToken",2);dt([d("mfa_code")],ft.prototype,"code",2);dt([d("remember_device")],ft.prototype,"rememberDevice",2);dt([d("state_token",de)],ft.prototype,"stateToken",2);class yr extends A{constructor(){super(...arguments);u(this,"errorKey")}}dt([d("error_key")],yr.prototype,"errorKey",2);const kn=Symbol("mfa_code_wrong");async function fl(e,t,n){const r=await Re(new URL("/orchestrator/v1/mfa/verify",pe),{method:"POST",body:ft.with(e),signal:t}).catch(he("failed to verify mfa"));switch(r.status){case 200:{const s=await r.json();await xe(s,n);const a=Ge.deserialize(s);if(a!=null&&a.stateToken)return a;break}case 401:{const s=await r.json(),a=yr.deserialize(s);return(a==null?void 0:a.errorKey)=="code_wrong"?kn:H}case 403:{const s=await r.json();switch(s.error_key){case"auth_locked":return qt;case"auth_suspended":return Kt;case"invalid_token":return H;default:V(s.error_key)}break}case 429:return Ee}throw new Y(r)}const fo=6;function pl({onError:e,generatedMfaOption:t,onMfaVerifyResponse:n,challenge:r,authToken:s,stateToken:a,showRememberDevice:i,source:p,mfaCode:c,setMfaCode:f}){const g=C(),w=_e(),[_,b]=l.useState(i),[x,v]=l.useState(null),E=Je(),P=Ln(),L=ge(),m=sn(),h=rn(),D=l.useRef(null),k=l.useCallback(B=>{b(B.target.checked)},[]),y=l.useCallback(async()=>{const B=Ue(t);let N=null;const F={failure_reason:null,mfa_type:B,device_environment_id:L,user_id:m},O={mfa_type:B,mfa_options:null,device_environment_id:L,customer_public_id:m,oidc_client_id:h,resource_id:null,failure_reason:null,source:p,remember_device:_,challenge:r};if(!P){E(!0);try{const U=await fl({code:c,authToken:s,challenge:r,rememberDevice:_,stateToken:a},w.signal,()=>{ot("submit_code",F),ie("submit_code",O)});switch(U){case H:N=Ct,e(U);break;case qt:N=vi,e(U);break;case Kt:N=ji,e(U);break;case kn:N=Ei,v(U);break;case Ee:N=sr,e(U);break;default:n==null||n(U.stateToken)}}catch(U){if(fe(U)){N=Qe;return}throw N=rr,e(me),U}finally{E(!1),F.failure_reason=N,O.failure_reason=N,ot("submit_code",F),ie("submit_code",O)}}},[t,L,m,h,p,_,P,E,c,s,r,a,w.signal,e,n]),X=l.useCallback(B=>{v(null),f(B)},[f]);l.useEffect(()=>{c.length===fo&&y()},[c]);const $=l.useMemo(()=>{switch(x){case kn:return g("{submitted_code} is not a valid code. Please check the code and try again.",{submitted_code:c})}},[x,g,c]);return o.jsx(ut,{testID:"mfa-verify-form",onSubmit:y,children:o.jsxs(M,{alignItems:"center",gap:"md",children:[o.jsxs(rt,{isInvalid:!!$,children:[o.jsx(st,{ref:D,value:c,maxLength:fo,onChange:l.useCallback(B=>X(B.target.value),[X]),type:"text",inputMode:"numeric",isDisabled:P,autoComplete:"one-time-code",autoFocus:!0,"data-testid":"mfa-code"}),o.jsx(at,{"data-testid":"mfa-code-error",children:$})]}),i&&o.jsx(Ao,{"data-testid":"mfa-remember-device",isChecked:_,onChange:k,children:g("Remember device")})]})})}function ml({option:e}){const t=C(),n=it();return l.useMemo(()=>{if(e instanceof wt)return o.jsxs(o.Fragment,{children:[o.jsx(z,{children:t("Confirm your security code")}),o.jsx(T,{children:n("**To get verified,** enter the 6-digit code sent to your mobile number **ending in {last_four}**",{last_four:e.lastFour})})]});if(e instanceof xt)return o.jsxs(o.Fragment,{children:[o.jsx(z,{children:t("Confirm your security code")}),o.jsx(T,{children:n("**To get verified,** enter the 6-digit code given in a phone call to your phone number ending in {last_four}",{last_four:e.lastFour})})]});if(e instanceof ct)return o.jsxs(o.Fragment,{children:[o.jsx(z,{children:t("Confirm your security code")}),o.jsx(T,{children:n("we sent it to **{email}**",{email:e.hint})})]});if(e==Xe)return o.jsxs(M,{gap:"md",children:[o.jsx(z,{children:t("Check your other phone or tablet")}),o.jsx(T,{children:n("We sent a notification to your other phone or tablet. Open the Remitly app there and tap **“Yes, it's me”**")}),o.jsx(T,{children:t("It will automatically sign you into this device")}),o.jsx(T,{as:"strong",children:t("Notification expires in 3 minutes.")})]});V()},[e,n,t])}function hl(e,t){const n=$e.useRef(e),[r,s]=$e.useState(!0);$e.useEffect(()=>{n.current=e},[e]),$e.useEffect(()=>{if(!t&&t!==0)return;const a=setTimeout(async()=>{await n.current()&&s(!r)},t);return()=>clearTimeout(a)},[t,r,s])}const _l=3e3;function gl({enabled:e,challenge:t,authToken:n,signal:r,stateToken:s,onResponse:a}){hl(async()=>{try{const i=await ll({authToken:n,challenge:t,stateToken:s},r);if(a(i),i==H)return!1}catch(i){if(fe(i))return!1;throw a(me),i}return!0},e?_l:null)}function wl({challenge:e,authToken:t,generatedMfaOption:n,devOnlyCode:r,resendCode:s,chooseMfa:a,chooseMfaButtonProps:i,onError:p,useDifferentAccountButton:c,mfaHelpLink:f,onMfaVerifyResponse:g,stateToken:w,showRememberDevice:_,source:b}){const x=C(),v=_e(),[E,P]=l.useState(!1),L=l.useMemo(()=>n!==Xe,[n]),[m,h]=l.useState("");gl({enabled:n==Xe,challenge:e,authToken:t,stateToken:w,signal:v.signal,onResponse:l.useCallback(k=>{k!=br&&p(k)},[p])});const D=l.useCallback(async()=>{h(""),P(!1),await s()&&P(!0)},[s,P]);return o.jsxs(M,{alignItems:"stretch",gap:"md",children:[o.jsx(re,{children:o.jsx(ee,{src:cl,height:"icon",width:"icon",alt:""})}),E&&o.jsx(Ro,{status:"success","data-testid":"code-resent-banner",children:x("Code resent")}),o.jsx(ml,{option:n}),r&&o.jsx(T,{children:o.jsxs(T,{as:"small",children:["Test environments only: your code is"," ",o.jsx(T,{as:"b","data-testid":"dev-only-code",children:r})]})}),L&&o.jsx(pl,{onError:p,generatedMfaOption:n,onMfaVerifyResponse:g,challenge:e,authToken:t,stateToken:w,showRememberDevice:_,source:b,mfaCode:m,setMfaCode:h}),o.jsx(R,{buttonType:W.Link,testID:"resend-mfa",title:x("Resend code"),onPress:D}),a&&o.jsx(R,{buttonType:W.Link,testID:"open-choose-mfa",title:x("Verify Another Way"),onPress:a,...i}),c,f]})}function xl({mfaType:e,authToken:t,stateToken:n,challenge:r,rememberDevice:s,setGeneratedResponse:a,onError:i,source:p,setHistoryState:c}){const f=ge(),g=Je(),w=sn(),_=rn(),b=_e(),x=l.useCallback(async P=>{g(!0);const L=P?"request_code":"rerequest_code";let m=null;const h={failure_reason:null,mfa_type:e,device_environment_id:f,user_id:w},D={mfa_type:e,mfa_options:null,device_environment_id:f,customer_public_id:w,oidc_client_id:_,resource_id:null,failure_reason:null,source:p,remember_device:s,challenge:r};try{const k=await Gn("generate_mfa",b.signal);if(!e)throw new Error("no MFA type on mfa option");const y=await Ha({mfaType:e,authToken:t,challenge:r,rememberDevice:s,stateToken:n,recaptchaToken:k},b.signal,()=>{h.failure_reason=so,D.failure_reason=so,ot(L,h),ie(L,D)});g(!1),y===H?(m=Ct,i(y)):y==Ee?(m=sr,i(y)):y instanceof Ge?c(y.stateToken):a(y)}catch(k){if(fe(k))return m=Qe,!1;throw m=jt,i(me),k}finally{g(!1),h.failure_reason=m,D.failure_reason=m,ot(L,h),ie(L,D)}return m===null},[g,e,f,w,_,p,s,b.signal,t,r,n,i,c,a]),v=l.useCallback(()=>x(!1),[x]),E=l.useCallback(()=>x(!0),[x]);return{resendCode:v,sendFirstTimeCode:E}}function vr({challenge:e,onCloseMfa:t,mfaRequiredResponse:n,generatedMfaCode:r,onMfaGeneratedResponse:s,onMfaVerifyResponse:a,onError:i,showRememberDevice:p,source:c,historyState:f,setHistoryState:g}){var ve,Fe,Ze;const w=C(),_=Vt(),b=ge(),x=sn(),v=rn(),{isOpen:E,onOpen:P,onClose:L,getButtonProps:m}=Nt(),[h,D]=l.useState(n.options[0]),k=l.useMemo(()=>Ue(h),[h]),y=l.useMemo(()=>{if(h instanceof wt)return w("Text Me");if(h instanceof xt)return w("Call Me");if(h instanceof ct)return w("Email Me");if(h==Xe)return w("Send notification");V()},[h,w]),X=l.useCallback(G=>{D(G),s(null),f!=null&&f.mfaGeneratedResponse&&(f.mfaGeneratedResponse=null,g(f))},[f,s,g]),$=l.useCallback(()=>{_.hide()},[_]),B=l.useCallback(G=>{switch(G){case H:_.show(Ie=>o.jsx(_r,{leastDestructiveRef:Ie,startOver:t,onClose:$}));break;case Ee:_.show(Ie=>o.jsx(Yi,{leastDestructiveRef:Ie,onClose:$}));break;default:i(G)}},[$,_,t,i]),N=l.useMemo(()=>o.jsx(ol,{isOpen:E,onClose:L,onChange:G=>{X(G),L()},options:n.options.filter(G=>Ue(G)!==Ue(h))}),[X,E,n.options,L,h]),F=l.useMemo(()=>{const G=()=>{ie("use_different_profile",{mfa_type:Ue(h),mfa_options:Cn(n.options),device_environment_id:b,customer_public_id:x,oidc_client_id:v,resource_id:null,source:c,failure_reason:null,remember_device:null,challenge:e}),t()};return o.jsx(R,{buttonType:W.Link,testID:"use-different-account",title:w("Use a different profile"),onPress:G})},[w,h,n.options,b,x,v,c,t,e]),O=l.useMemo(()=>o.jsx(Ji,{mfaType:k,mfaOptions:n.options,source:c,challenge:e}),[k,n,c,e]),U=n.options.length>1,{resendCode:se,sendFirstTimeCode:ye}=xl({mfaType:k,authToken:n.authToken,stateToken:n.stateToken,challenge:e,rememberDevice:!1,setGeneratedResponse:s,onError:B,source:c,setHistoryState:g});if(l.useEffect(()=>{ot("challenged",{failure_reason:null,mfa_type:Ue(h),device_environment_id:b,user_id:x}),ie("challenge",{mfa_type:Ue(h),mfa_options:Cn(n.options),device_environment_id:b,customer_public_id:x,oidc_client_id:v,resource_id:null,source:c,failure_reason:null,remember_device:!1,challenge:e})},[]),r){const{option:G,devOnlyCode:Ie}=r;return o.jsxs(o.Fragment,{children:[o.jsx(wl,{onError:B,authToken:n.authToken,challenge:e,generatedMfaOption:G,devOnlyCode:Ie,resendCode:se,chooseMfa:U?P:null,chooseMfaButtonProps:m,useDifferentAccountButton:F,mfaHelpLink:O,onMfaVerifyResponse:a,stateToken:(Ze=(Fe=(ve=f==null?void 0:f.mfaGeneratedResponse)==null?void 0:ve.stateToken)!=null?Fe:f==null?void 0:f.mfaRequiredResponse.stateToken)!=null?Ze:null,showRememberDevice:p,source:c},JSON.stringify(G)),N]})}return o.jsxs(o.Fragment,{children:[o.jsxs(M,{alignItems:"stretch",gap:"md",children:[o.jsx(re,{children:o.jsx(ee,{src:sl,height:"icon",width:"icon",alt:""})}),o.jsx(z,{testID:"mfa-flow-".concat(k),children:w("Verify it's you")}),o.jsx(Qi,{option:h}),o.jsx(R,{title:y,onPress:ye,testID:"generate-mfa"}),U&&o.jsx(R,{testID:"open-choose-mfa",title:w("Verify Another Way"),buttonType:W.Outline,onPress:P,...m}),F,O]}),N]})}function bl({email:e,setEmail:t,emailError:n,challenge:r,country:s,onError:a,validate:i,validationController:p,newAccount:c,resumeMfa:f,startOver:g,openLogin:w,openRegister:_,openPasswordReset:b,historyState:x,setHistoryState:v,preselectMarketingSubscription:E,showMarketingSubscription:P,showSSO:L,clientName:m}){var te,Et;const h=C(),D=it(),{isOpen:k,onToggle:y}=Nt(),X=K.SHOW_GOOGLE_BUTTON,$=K.SHOW_APPLE_BUTTON,[B,N]=l.useState((te=f==null?void 0:f.mfaGeneratedResponse)!=null?te:null),[F,O]=l.useState(E),U=l.useCallback(Be=>{O(Be.target.checked)},[]),se=l.useMemo(()=>{if(P)return o.jsx(Ao,{"data-testid":"marketing-subscription",isChecked:F,onChange:U,children:o.jsx(T,{fontSize:"sm",children:h("Remitly may contact you regarding special promotions that we often run for our customers, including FX rate promotions, fee discounts and prize draws. If you do not wish to receive these messages, please uncheck this box.")})})},[h,U,F,P]),ye=P?F:E?!0:null,[ve,Fe]=l.useState(!1),[Ze,G]=l.useState(null);l.useEffect(()=>{var Be;if(x!==null&&"raw"in x)if(x.linkingLoginIdentifier!==null&&((Be=x.steps)==null?void 0:Be[0].step)=="link_account"){switch(x.linkingLoginIdentifier.type){case"apple_sso":G("Apple");break;case"google_sso":G("Google");break;case"email":throw new Error("unsupported identier type for account linking");default:V()}Fe(!0)}else G(null),Fe(!1)},[x]);const Ie=l.useMemo(()=>h(ve?"Confirm your Remitly password":c?"Create a Remitly profile":"Sign in with Remitly"),[ve,h,c]),dn=l.useCallback(()=>{Ae.remove(es),N(null),Fe(!1),g()},[g]),pt="click",Te=ge(),J=l.useCallback(()=>{tt(pt,{device_environment_id:Te,screen:"one auth sign in",target:"join now",context:"sign in page"}),_()},[_,Te]),we=l.useCallback(()=>{tt(pt,{device_environment_id:Te,screen:"one auth sign up",target:"sign in",context:"sign up page"}),w()},[w,Te]),Ke=l.useMemo(()=>o.jsxs(o.Fragment,{children:[o.jsx(T,{children:c?D("Already have a profile? {sign_in}",{sign_in:o.jsx(At,{testID:"switch-to-login-or-registration",title:h("Sign In"),onPress:we})}):D("Need a profile? {join_now}",{join_now:o.jsx(At,{testID:"switch-to-login-or-registration",title:h("Join Now"),onPress:J})})}),s=="AE"&&c?o.jsxs(T,{dir:"rtl",children:["هل لديك حساب بالفعل؟"," ",o.jsx(At,{testID:"switch-to-login-or-registration-ae",title:"تسجيل الدخول",onPress:we})]}):null]}),[s,h,D,c,we,J]),mt=l.useMemo(()=>{if(!$&&!X)return;const Be=o.jsxs(Ut,{position:"relative",padding:"5",children:[o.jsx(ts,{colorScheme:"blackAlpha"}),o.jsx(ns,{bg:"white",px:"3",children:o.jsx(T,{as:"b",children:h("or")})})]});return L?o.jsxs(o.Fragment,{children:[Be,X&&o.jsx(lo,{challenge:r,marketingSubscriptionStatus:ye}),$&&o.jsx(io,{challenge:r,marketingSubscriptionStatus:ye})]}):o.jsxs(o.Fragment,{children:[o.jsx(R,{testID:"sso-options-btn",buttonType:W.Link,title:h("More login options"),onPress:y}),o.jsx(os,{in:k,animateOpacity:!0,children:o.jsxs(M,{gap:"md",alignItems:"stretch",children:[Be,X&&o.jsx(lo,{challenge:r,marketingSubscriptionStatus:ye}),$&&o.jsx(io,{challenge:r,marketingSubscriptionStatus:ye})]})})]})},[r,h,k,ye,y,$,X,L]);return l.useEffect(()=>{c?Ne("visit_register",{device_environment_id:Te,challenge:r,failure_reason:null}):Ne("visit_login",{device_environment_id:Te,challenge:r,failure_reason:null})},[c,Te,r]),x instanceof ne?o.jsx(ce,{suffix:h("Verify it's you"),children:o.jsx(Wn.Provider,{value:x.mfaRequiredResponse.productLineUserId,children:o.jsx(zn.Provider,{value:x.mfaRequiredResponse.oidcClientId,children:o.jsx(vr,{onCloseMfa:dn,challenge:r,mfaRequiredResponse:x.mfaRequiredResponse,generatedMfaCode:(Et=x.mfaGeneratedResponse)!=null?Et:B,onMfaGeneratedResponse:N,onMfaVerifyResponse:null,onError:a,showRememberDevice:!0,source:"login",historyState:x,setHistoryState:v})})})}):o.jsx(ce,{suffix:h(c?"Join now":"Sign In"),children:o.jsxs(M,{gap:"md",alignItems:"stretch",children:[o.jsx(z,{children:Ie}),ve&&o.jsx(ae,{children:D("To finish connecting your {sso_provider} account, enter the password for **{email}**",{sso_provider:Ze,email:e})}),o.jsx(Ki,{email:e,setEmail:t,emailError:n,newAccount:c,country:s,challenge:r,onError:a,onAuth:v,validate:i,validationController:p,marketingSubscriptionComponent:se,marketingSubscriptionStatus:ye,accountLinking:ve,historyState:x,clientName:m}),!ve&&o.jsxs(o.Fragment,{children:[!c&&o.jsx(R,{buttonType:W.Link,testID:"forgot-password",title:h("Forgot password"),onPress:b}),o.jsx(M,{children:Ke}),mt]})]})})}function Pe(e,t){lt("auth_forgot_password_flow/1.4",e,t)}const qn=""+window.CDN_URL+"assets/password-d5VAAOqL.svg";function jr(e){const t=C();return o.jsxs(M,{alignItems:"stretch",gap:"md",children:[o.jsx(re,{children:o.jsx(ee,{src:qn,height:"icon",width:"icon",alt:""})}),o.jsx(z,{children:t("Your password has been reset")}),o.jsx(ae,{children:t("Please sign in again with your new password.")}),o.jsx(ae,{children:t("You may close this window now.")}),e.shouldShowLoginButton&&o.jsx(R,{testID:"signin-btn",title:t("Sign In"),onPress:()=>e.onSubmit?e.onSubmit():null})]})}var yl=Object.defineProperty,vl=Object.getOwnPropertyDescriptor,cn=(e,t,n,r)=>{for(var s=r>1?void 0:r?vl(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&yl(t,n,s),s};class Pt extends A{constructor(){super(...arguments);u(this,"loginIdentifier");u(this,"loginChallenge");u(this,"recaptchaToken");u(this,"stateToken")}}cn([d("login_identifier")],Pt.prototype,"loginIdentifier",2);cn([d("login_challenge")],Pt.prototype,"loginChallenge",2);cn([d("recaptcha_token")],Pt.prototype,"recaptchaToken",2);cn([d("state_token",de)],Pt.prototype,"stateToken",2);async function jl(e,t,n){const r=await Re(new URL("/orchestrator/v1/password_reset/start",pe),{method:"POST",body:Pt.with({...e,loginIdentifier:yt.with(e.loginIdentifier)}),signal:t}).catch(he("failed to start password reset"));switch(r.status){case 200:{const s=await r.json();await xe(s,n);const a=oe.deserialize(s);if(!a)throw new Error("response is null or empty",{cause:new Y(r)});if(!a.stateToken)throw new Error("state token is null or empty",{cause:new Y(r)});return a}case 400:{const s=await r.json();if(s.error_key=="email")return ht;V(s.error_key);break}case 403:{const s=await r.json();switch(s.error_key){case"bot_detected":return Yt;default:V(s.error_key)}break}case 429:return Ee}throw new Y(r)}function ze(e,t){const n={...gr,...xr,...wr,...t};lt("forgot_password_flow/1.1",e,n)}function Cl({challenge:e,email:t,emailError:n,goToLogin:r,onEmailChange:s,onError:a,onSubmit:i,validate:p,stateToken:c,clientName:f}){var m,h;const g=C(),w=Je(),_=ge(),b=_e(),[x,v]=l.useState(null),[E,P]=l.useState(null);l.useEffect(()=>{ze("visits_request_password",{user_id:null,reset_id:null,verification_data:null,device_environment_id:_,failure_reason:null}),Pe("visit_request_password",{device_environment_id:_,customer_public_id:null,resource_id:null,oidc_client_id:null,address_type:"email",challenge:e,failure_reason:null})},[_,e]);const L=l.useCallback(async()=>{var X,$;let D=null;const k={user_id:null,reset_id:e,verification_data:null,device_environment_id:_,failure_reason:null},y={device_environment_id:_,customer_public_id:null,resource_id:null,oidc_client_id:null,address_type:"email",challenge:e,failure_reason:null};if(!await p()){Bt(x),P(null),k.failure_reason=nt,y.failure_reason=nt,ze("submit_request_reset",k),Pe("submit_request_reset",y);return}w(!0);try{const B=f==pr||f==mr?"start_password_reset_native":"start_password_reset";let N;((X=c==null?void 0:c.requiredAuthFactor)==null?void 0:X[0])==="manual_recaptcha"?N=E:N=await Gn(B,b.signal);const F=await jl({loginIdentifier:{value:t,type:"email"},loginChallenge:e,recaptchaToken:N,stateToken:c},b.signal,()=>{k.failure_reason=ao,y.failure_reason=ao,ze("submit_request_reset",k),Pe("submit_request_reset",y)});if(F instanceof oe){const O=F==null?void 0:F.stateToken;O!=null&&(k.user_id=O.productLineUserId,y.customer_public_id=O.productLineUserId,y.oidc_client_id=O.oidcClientID,(($=O.requiredAuthFactor)==null?void 0:$[0])=="manual_recaptcha"&&(D=ki))}switch(F){case Ee:D=$n,a(F);break;case ht:D=Pi,a(F);break;case Yt:D=Ci,a(F);break;default:i(F)}}catch(B){if(fe(B)){D=Qe;return}throw D=jt,a(me),B}finally{Bt(x),P(null),k.failure_reason=D,y.failure_reason=D,ze("submit_request_reset",k),Pe("submit_request_reset_confirm",y),w(!1)}},[e,_,p,w,b.signal,t,a,i,E,c,x,f]);return o.jsx(ut,{onSubmit:L,children:o.jsxs(M,{alignItems:"stretch",gap:"md",children:[o.jsx(re,{children:o.jsx(ee,{src:qn,height:"icon",width:"icon",alt:""})}),o.jsx(z,{children:g("Change your password")}),o.jsx(ae,{children:g("We’ll send instructions to the email you enter below.")}),o.jsx(ur,{value:t,onChange:s,error:n}),((m=c==null?void 0:c.requiredAuthFactor)==null?void 0:m[0])==="manual_recaptcha"&&o.jsx(hr,{setManualRecaptchaToken:P,setRecaptchaWidgetId:v}),o.jsx(R,{testID:"reset-password-request-btn",title:g("Continue"),submits:!0,disabled:((h=c==null?void 0:c.requiredAuthFactor)==null?void 0:h[0])==="manual_recaptcha"&&E==null}),o.jsx(R,{buttonType:W.Link,title:g("Sign In"),submits:!1,onPress:r})]})})}var Pl=Object.defineProperty,kl=Object.getOwnPropertyDescriptor,un=(e,t,n,r)=>{for(var s=r>1?void 0:r?kl(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&Pl(t,n,s),s};class kt extends A{constructor(){super(...arguments);u(this,"loginChallenge");u(this,"newPassword");u(this,"stateToken");u(this,"language")}}un([d("login_challenge")],kt.prototype,"loginChallenge",2);un([d("new_password")],kt.prototype,"newPassword",2);un([d("state_token",de)],kt.prototype,"stateToken",2);un([d],kt.prototype,"language",2);const Cr=Symbol("weak_password");async function El(e,t,n){const r=await Re(new URL("/orchestrator/v1/account/password/set",pe),{method:"POST",body:kt.with({language:Oe(),...e}),signal:t}).catch(he("failed to set password"));switch(r.status){case 200:{const s=await r.json();await xe(s,n);const a=Ge.deserialize(s);if(a!=null&&a.stateToken)return a;break}case 401:return H;case 406:return Cr}throw new Y(r)}function Dl({stateToken:e,challenge:t,onSubmit:n,onError:r}){const{validationController:s,validate:a}=on(),i=C(),p=Je(),{password:c,setPassword:f,passwordError:g,setPasswordExternalError:w,passwordHelperText:_}=dr(s,a),b=_e(),x=ge(),v=e.productLineUserId,E=e.oidcClientID,P=e.loginIdentifier.type;l.useEffect(()=>{ze("visits_reset_view",{user_id:v,reset_id:t,verification_data:null,device_environment_id:x,failure_reason:null}),Pe("visit_reset_view",{device_environment_id:x,customer_public_id:v,resource_id:null,oidc_client_id:E,address_type:P,challenge:t,failure_reason:null})},[t,x,v,E,P]);const L=l.useCallback(async()=>{var k;let m=null;const h={user_id:v,reset_id:t,verification_data:null,device_environment_id:x,failure_reason:null},D={device_environment_id:x,customer_public_id:v,resource_id:null,oidc_client_id:E,address_type:P,challenge:t,failure_reason:null};if(!await a()){h.failure_reason=nt,D.failure_reason=nt,ze("submit_new_password",h),Pe("submit_new_password",D);return}Pe("submit_new_password",D),p(!0);try{const y=await El({loginChallenge:t,newPassword:c,stateToken:e},b.signal,()=>{ze("submit_new_password",h),Pe("submit_new_password_confirm",D)});y==Cr?w(en):y==H?(m=Ct,r(H)):n((k=y==null?void 0:y.stateToken)!=null?k:{raw:"",requiredAuthFactor:[],additionalSteps:[]})}catch(y){if(fe(y)){m=Qe;return}throw m=jt,r(me),y}finally{h.failure_reason=m,D.failure_reason=m,ze("submit_new_password",h),Pe("submit_new_password_confirm",D),p(!1)}},[t,r,n,c,p,w,e,a,x]);return o.jsx(ut,{onSubmit:L,children:o.jsxs(M,{alignItems:"stretch",gap:"md",children:[o.jsx(re,{children:o.jsx(ee,{src:qn,height:"icon",width:"icon",alt:""})}),o.jsx(z,{children:i("Change your password")}),o.jsx(ae,{children:i("For security, create a password using at least 8 characters.")}),o.jsx(Bi,{value:e.loginIdentifier.value}),o.jsx(fr,{label:i("New Password"),value:c,newPassword:!0,onChange:f,error:g,validationController:s,autoFocus:!0,passwordHelperText:_}),o.jsx(R,{testID:"reset-password-submit-btn",title:i("Change Password"),submits:!0})]})})}var Il=Object.defineProperty,Tl=Object.getOwnPropertyDescriptor,Kn=(e,t,n,r)=>{for(var s=r>1?void 0:r?Tl(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&Il(t,n,s),s};class Yn extends A{constructor(){super(...arguments);u(this,"stateToken");u(this,"authFactorValue")}}Kn([d("state_token",de)],Yn.prototype,"stateToken",2);Kn([d("auth_factor_value")],Yn.prototype,"authFactorValue",2);class Pr extends A{constructor(){super(...arguments);u(this,"errorKey")}}Kn([d("error_key")],Pr.prototype,"errorKey",2);const _t=Symbol("value_wrong");async function kr(e,t){const n=await Re(new URL("/orchestrator/v1/mfa/auth_factor",pe),{method:"POST",body:Yn.with(e),signal:t}).catch(he("failed to post mfa auth factor"));switch(n.status){case 200:{const r=await n.json();await xe(r,null);const s=Ge.deserialize(r);if(s!=null&&s.stateToken)return s;break}case 401:{const r=await n.json(),s=Pr.deserialize(r);return(s==null?void 0:s.errorKey)=="value_wrong"?_t:H}case 429:return Ee}throw new Y(n)}const Ll=""+window.CDN_URL+"assets/calendar-DuR1OFut.svg",Al=(()=>{let e=new Date;const t=e.getTimezoneOffset();return e=new Date(e.getTime()-t*60*1e3),e.toISOString().split("T")[0]})();function Rl({stateToken:e,onComplete:t,onError:n}){const r=C(),s=Je(),[a,i]=l.useState(null),{validationController:p,validate:c}=on(),f=ge(),g=e.productLineUserId,w=e.oidcClientID,_=e.challenge,[b,x,v]=vt("",m=>a==_t?r("We can't confirm that date. Try again."):(a==null||V(),isNaN(new Date(m))?r("Select or enter your full date of birth"):null),p);l.useEffect(()=>{a&&c()},[a,c]);const E=l.useCallback(m=>{x(m),i(null)},[x]);l.useEffect(()=>{ie("visit_identity_verification",{mfa_type:"dob",mfa_options:null,device_environment_id:f,customer_public_id:g,oidc_client_id:w,resource_id:null,source:"pw_reset",failure_reason:null,remember_device:null,challenge:_})},[f,g,w,_]);const P=_e(),L=l.useCallback(async()=>{const m={mfa_type:"dob",mfa_options:null,device_environment_id:f,customer_public_id:g,oidc_client_id:w,resource_id:null,failure_reason:null,source:"pw_reset",remember_device:null,challenge:_};if(!await c()){m.failure_reason=nt,ie("submit_identity_verification",m);return}s(!0);try{const h=await kr({stateToken:e,authFactorValue:b},P.signal);switch(h){case H:m.failure_reason=Ct,n(h);break;case Ee:m.failure_reason=$n,n(h);break;case _t:m.failure_reason=or,i(h);break;default:t(h.stateToken)}}catch(h){if(fe(h)){m.failure_reason=Qe;return}throw m.failure_reason=jt,n(me),h}finally{ie("submit_identity_verification",m),s(!1)}},[f,g,w,c,s,e,b,P.signal,n,t,_]);return o.jsx(ut,{onSubmit:L,children:o.jsxs(M,{alignItems:"stretch",gap:"md",children:[o.jsx(re,{children:o.jsx(ee,{src:Ll,height:"icon",width:"icon",alt:""})}),o.jsx(z,{children:r("Enter your date of birth")}),o.jsx(ae,{children:r("This helps us confirm your identity")}),o.jsxs(rt,{isInvalid:!!v,children:[o.jsx(gt,{children:r("Date of Birth")}),o.jsx(st,{autoComplete:"bday",value:b,onChange:l.useCallback(m=>E(m.target.value),[E]),autoFocus:!0,"data-testid":"dob-input",type:"date",max:Al}),o.jsx(at,{"data-testid":"date-input-error-dob-input",children:v})]}),o.jsx(R,{testID:"dob-submit-button",title:r("Confirm"),submits:!0})]})})}function Ol({stateToken:e,onComplete:t,onError:n}){const r=C(),s=Je(),[a,i]=l.useState(null),{validationController:p,validate:c}=on(),f=ge(),g=e.productLineUserId,w=e.oidcClientID,_=e.challenge,[b,x,v]=vt("",m=>m.length!=4?r("Must be 4 digits long"):a==_t?r("Can't confirm. Try again."):(a==null||V(),null),p);l.useEffect(()=>{a&&c()},[a,c]);const E=l.useCallback(m=>{x(m),i(null)},[x]);l.useEffect(()=>{ie("visit_identity_verification",{mfa_type:"payment_last_four",mfa_options:null,device_environment_id:f,customer_public_id:g,oidc_client_id:w,resource_id:null,source:"pw_reset",failure_reason:null,remember_device:null,challenge:_})},[f,g,w,_]);const P=_e(),L=l.useCallback(async()=>{const m={mfa_type:"payment_last_four",mfa_options:null,device_environment_id:f,failure_reason:null,customer_public_id:g,oidc_client_id:w,resource_id:null,source:"pw_reset",remember_device:null,challenge:_};if(!await c()){m.failure_reason=nt,ie("submit_identity_verification",m);return}s(!0);try{const h=await kr({stateToken:e,authFactorValue:b},P.signal);switch(h){case H:m.failure_reason=Ct,n(h);break;case Ee:m.failure_reason=$n,n(h);break;case _t:m.failure_reason=or,i(h);break;default:t(h.stateToken)}}catch(h){if(fe(h)){m.failure_reason=Qe;return}throw m.failure_reason=jt,n(me),h}finally{ie("submit_identity_verification",m),s(!1)}},[f,g,w,c,s,e,b,P.signal,n,t,_]);return o.jsx(ut,{onSubmit:L,children:o.jsxs(M,{alignItems:"stretch",gap:"md",children:[o.jsx(re,{children:o.jsx(ee,{src:Wo,height:"icon",width:"icon",alt:""})}),o.jsx(z,{children:r("Verify your details")}),o.jsx(ae,{children:r("Enter the last four numbers from your bank account, debit card, or credit card.")}),o.jsxs(rt,{isInvalid:!!v,children:[o.jsx(gt,{children:r("Last four numbers")}),o.jsx(st,{autoComplete:"off",type:"number",inputMode:"numeric",maxLength:4,value:b,onChange:l.useCallback(m=>E(m.target.value),[E]),autoFocus:!0,"data-testid":"payment-last-four-input"}),o.jsx(at,{"data-testid":"text-input-error-payment-last-four-input",children:v})]}),o.jsx(R,{testID:"payment-last-four-submit-button",title:r("Confirm"),submits:!0})]})})}function It({onPress:e}){const t=C();return o.jsx(R,{buttonType:W.Link,href:va,hrefAttrs:ue,onPress:e,title:t("Get help")})}function Sl({email:e,emailError:t,onEmailChange:n,startOver:r,openLogin:s,onError:a,challenge:i,validate:p,historyState:c,setHistoryState:f,clientName:g}){var y,X,$,B,N,F;const w=C(),_=ge(),b=c!=null&&!(c instanceof ne)?c.productLineUserId:null,x=c!=null&&!(c instanceof ne)?c.oidcClientID:null,v=l.useCallback(O=>{f(ne.with({mfaRequiredResponse:O,mfaGeneratedResponse:null}))},[f]),E=l.useCallback(O=>{if(c instanceof ne)c.mfaGeneratedResponse=O,f(c);else throw new Error("failed to set mfa generated response in state")},[c,f]),P=Vt(),L=l.useCallback(()=>{P.hide()},[P]),m=l.useCallback(O=>{switch(O){case H:P.show(U=>o.jsx(_r,{leastDestructiveRef:U,startOver:r,onClose:L}));break;default:a(O)}},[L,P,r,a]),h=l.useCallback(()=>{Pe("request_help_visit_request",{device_environment_id:_,customer_public_id:null,resource_id:null,oidc_client_id:null,address_type:"email",challenge:i,failure_reason:null})},[_,i]),D=l.useCallback(O=>{ie("request_help",{mfa_type:O,mfa_options:null,device_environment_id:_,customer_public_id:b,oidc_client_id:x,resource_id:null,source:"pw_reset",failure_reason:null,remember_device:null,challenge:i})},[x,b,_,i]),k=l.useCallback(()=>{c!=null&&!(c instanceof ne)&&Pe("request_help_visit_reset",{device_environment_id:_,customer_public_id:c.productLineUserId,resource_id:null,oidc_client_id:c.oidcClientID,address_type:"email",challenge:i,failure_reason:null})},[c,_,i]);if(c==null||c instanceof ne&&(($=(X=(y=c==null?void 0:c.mfaRequiredResponse)==null?void 0:y.stateToken)==null?void 0:X.requiredAuthFactor)==null?void 0:$[0])==="manual_recaptcha")return o.jsxs(ce,{suffix:w("Change your password"),children:[o.jsx(Cl,{email:e,emailError:t,onEmailChange:n,onSubmit:v,challenge:i,onError:m,goToLogin:s,validate:p,stateToken:(N=(B=c==null?void 0:c.mfaRequiredResponse)==null?void 0:B.stateToken)!=null?N:null,clientName:g}),o.jsx(It,{onPress:h})]});if(c instanceof ne)return o.jsx(ce,{suffix:w("Verify it's you"),children:o.jsx(M,{alignItems:"stretch",gap:"md",children:o.jsx(Wn.Provider,{value:c.mfaRequiredResponse.stateToken?c.mfaRequiredResponse.stateToken.productLineUserId:null,children:o.jsx(zn.Provider,{value:c.mfaRequiredResponse.stateToken?(F=c.mfaRequiredResponse.stateToken)==null?void 0:F.oidcClientID:null,children:o.jsx(vr,{onCloseMfa:r,generatedMfaCode:c.mfaGeneratedResponse,mfaRequiredResponse:c.mfaRequiredResponse,challenge:i,onMfaGeneratedResponse:E,onMfaVerifyResponse:f,onError:m,showRememberDevice:!1,source:"pw_reset",historyState:c,setHistoryState:f})})})})});if(c.requiredAuthFactor.length>0){const O=c.requiredAuthFactor[0];let U,se;switch(O){case"dob":U="dob",se=Rl;break;case"payment_last_four":U="payment_last_four",se=Ol;break;case"manual_recaptcha":throw new Error("Unexpected manual_recaptcha auth factor in password reset flow");case"password":throw new Error("Unexpected password auth factor in password reset flow");default:V()}return o.jsxs(o.Fragment,{children:[l.createElement(se,{onError:m,stateToken:c,onComplete:f}),o.jsx(It,{onPress:()=>D(U)})]})}if(c.additionalSteps.length>0)switch(c.additionalSteps[0]){case"password_reset":return o.jsxs(ce,{suffix:w("Change your password"),children:[o.jsx(Dl,{stateToken:c,onSubmit:f,challenge:i,onError:m}),o.jsx(It,{onPress:k})]});case"mfa":case"link_account":throw new Error("Unexpected link_account_identifier additional step in password reset flow");default:V()}return o.jsxs(ce,{suffix:w("Your password has been reset"),children:[o.jsx(jr,{onSubmit:s,shouldShowLoginButton:!0}),o.jsx(It,{}),o.jsx(R,{buttonType:W.Link,testID:"use-different-account",title:w("Use a different profile"),onPress:r})]})}function Ml({historyState:e,setHistoryState:t,challenge:n,rootPage:r,openLogin:s,openPasswordReset:a,openRegister:i,loginRequiredResponse:p}){var h,D;const c=C(),f=Vt(),{validationController:g,validate:w}=on(),[_,b]=l.useState(null),[x,v,E]=vt((D=(h=p.hint)==null?void 0:h.email)!=null?D:"",function(y){return _==ht?c("Please enter a valid email address"):(_==null||V(),(r=="register"?wi:gi)(y)?null:c("Please enter a valid email address"))},g),P=l.useCallback(k=>{v(k),b(null)},[v]);l.useEffect(()=>{_&&w()},[_,w]);const L=l.useCallback(()=>{t(null),s()},[s,t]),m=l.useCallback(k=>{switch(k){case ht:b(k);break;case H:f.show(y=>r=="register"?o.jsx(mi,{leastDestructiveRef:y,onClose:f.hide,openPasswordReset:a,rpDeviceEnvironmentId:p.rpDeviceEnvironmentId}):o.jsx(di,{leastDestructiveRef:y,onClose:f.hide,openPasswordReset:a,openRegister:i,rpDeviceEnvironmentId:p.rpDeviceEnvironmentId}));break;case qt:f.show(y=>o.jsx(li,{leastDestructiveRef:y,onClose:f.hide,openPasswordReset:a}));break;case Kt:f.show(y=>o.jsx(ci,{leastDestructiveRef:y,onClose:f.hide}));break;case Ee:f.show(y=>o.jsx(pi,{leastDestructiveRef:y,onClose:f.hide}));break;case Jo:f.show(y=>o.jsx(fi,{leastDestructiveRef:y,rpDeviceEnvironmentId:p.rpDeviceEnvironmentId,onClose:f.hide,onLogin:()=>{s(),f.hide()}}));break;case me:f.show(y=>o.jsx(ii,{leastDestructiveRef:y,onClose:f.hide}));break;case Yt:f.show(y=>o.jsx(ui,{leastDestructiveRef:y,onClose:f.hide}));break;default:V()}},[r,f,a,i,s,p.rpDeviceEnvironmentId]);switch(r){case"password_reset":return o.jsx(Sl,{email:x,onEmailChange:P,startOver:L,openLogin:s,onError:m,challenge:n,emailError:E,validate:w,historyState:e,setHistoryState:t,clientName:p.clientName});case"login":case"register":return o.jsx(bl,{email:x,setEmail:P,emailError:E,challenge:n,country:p.country,onError:m,validate:w,validationController:g,newAccount:r==="register",startOver:L,openLogin:s,openRegister:i,openPasswordReset:a,resumeMfa:p.resumeMfa,historyState:e,setHistoryState:t,preselectMarketingSubscription:p.preselectMarketingSubscription,showMarketingSubscription:p.showMarketingSubscription,showSSO:p.showSSO,clientName:p.clientName});case"confirm_account":return o.jsx(Di,{email:x,challenge:n,onError:m});default:V()}}function Fl(){const e=Wt(),t=Ht();if(l.useEffect(()=>{var r,s,a;if(e instanceof Error)return;const n=(s=(r=t.state)==null?void 0:r.root)!=null?s:e.payload.rootPage;Z.setUser(void 0,(a=e.payload.hint)==null?void 0:a.email),Z.addMetadata("Device",{rpDeviceEnvironmentId:e.payload.rpDeviceEnvironmentId}),Z.addMetadata("LoginRequiredResponse",{loginHint:e.payload.hint,clientName:e.payload.clientName,rootPage:n,country:e.payload.country})},[e,t]),e instanceof Error)return o.jsx(nn,{error:e});if(e.errorCode){const n=new URLSearchParams(t.search);n.delete("error"),history.pushState(null,"",window.location.pathname+"?"+n.toString())}return o.jsx(Er,{loginRequiredResponse:e.payload,challenge:e.challenge,errorCode:e.errorCode})}function po(e){var r;const t=(r=e.steps)==null?void 0:r[0].mfa;if(!t)throw new Error("expected mfa data");const n=ne.with({mfaRequiredResponse:oe.with({options:t.options.mfa_options,authToken:e.authToken,registerAutoLogin:t.options.register_auto_login,productLineUserId:e.productLineUserId,oidcClientId:e.oidcClientID,stateToken:e})});return t!=null&&t.codeData&&(n.mfaGeneratedResponse=Ve.with({option:t.codeData.option,expiresAfterMillis:t.codeData.expiresAfterMillis,devOnlyCode:t.codeData.devOnlyCode,stateToken:e})),n}function Er({loginRequiredResponse:e,challenge:t,errorCode:n}){var E,P,L;const r=l.useState(!1),s=To(),a=Ht(),i=l.useCallback(m=>{s(a,{state:{root:m}}),c(null)},[a,s]),[p,c]=l.useState(n),[f,g]=ai(l.useCallback(m=>{var h;if(!m)return null;if(typeof m=="object"&&m.serialized){const D=(()=>{switch(m.type){case"resume_mfa":return ne;case"state_token":return de;default:V(m.type)}})(),k=Tn(D,m.serialized);if(!k)throw new Error("failed to deserialize history state");return"raw"in k&&((h=k.steps)==null?void 0:h[0].step)==="mfa"?po(k):k}throw new Error("unknown state")},[]),l.useCallback(m=>{var h;return m?m instanceof ne?{serialized:m.serialize(),type:"resume_mfa"}:((h=m.steps)==null?void 0:h[0].step)==="mfa"?{serialized:po(m).serialize(),type:"resume_mfa"}:{serialized:ko(de,m),type:"state_token"}:null},[])),w=e!=null&&e.resumeMfa?e==null?void 0:e.resumeMfa:(E=e==null?void 0:e.stateToken)!=null?E:null;l.useEffect(()=>{var m;(m=a.state)!=null&&m.root||(s(a,{state:{root:e.rootPage},replace:!0}),g(w))},[]);const _=l.useCallback(()=>i("login"),[i]),b=l.useCallback(()=>i("register"),[i]),x=l.useCallback(()=>i("password_reset"),[i]),v=(L=(P=a.state)==null?void 0:P.root)!=null?L:e.rootPage;return o.jsx(Un.Provider,{value:e.rpDeviceEnvironmentId,children:o.jsx(Uo,{state:r,children:o.jsxs(M,{alignItems:"stretch",gap:"mdLg",children:[p&&o.jsxs(Ro,{status:"error",children:[o.jsx(rs,{}),p]}),o.jsx(Ml,{challenge:t,historyState:f,setHistoryState:g,rootPage:v,openRegister:b,openLogin:_,openPasswordReset:x,loginRequiredResponse:e})]})})})}function Bl(){const e=l.useState(!1),t=Wt(),n=Ht();if(l.useEffect(()=>{t instanceof Error},[t,n]),t instanceof Error)return o.jsx(nn,{error:t});if(t.payload.stateToken==null)throw new Error("unable to load state token");return o.jsx(Un.Provider,{value:t.payload.rpDeviceEnvironmentId,children:o.jsx(Uo,{state:e,children:o.jsx(M,{alignItems:"stretch",gap:"mdLg",children:o.jsx(Er,{loginRequiredResponse:t.payload,challenge:t.payload.stateToken.challenge})})})})}function Ul(){const e=Wt(),t=C();if(e instanceof Error)return o.jsx(nn,{error:e});const n=t("Do you want to log out of {client_name}?",{client_name:e.payload.clientName||t("Remitly")});return o.jsxs(M,{gap:"mdLg",alignItems:"stretch",children:[o.jsx(z,{children:n}),o.jsx(Nl,{challenge:e.challenge})]})}const En=Symbol("loading");function Nl({challenge:e}){const[t,n]=l.useState(null),r=_e(),s=l.useCallback(async({acceptLogout:a})=>{n(En);try{n(await Ja({challenge:e,acceptLogout:a},r.signal))}catch(i){if(fe(i))return;throw n(me),i}},[r.signal,e]);return o.jsx($l,{submit:s,logoutState:t})}function $l({submit:e,logoutState:t}){const n=C(),r=l.useCallback(()=>{e({acceptLogout:!0})},[e]),s=l.useCallback(()=>{e({acceptLogout:!1})},[e]);return o.jsxs(M,{gap:"md",alignItems:"stretch",children:[t==me?o.jsx(T,{"data-testid":"api-error",children:"We're sorry, something went wrong"}):null,o.jsx(R,{testID:"log-out-confirm",onPress:r,title:n("Log out"),disabled:t==En}),o.jsx(R,{testID:"log-out-cancel",buttonType:W.Outline,onPress:s,title:n("Cancel"),disabled:t==En})]})}function zl(){const e=C(),[t]=Io(),n=t.get("is_logged_out");return o.jsx(T,{children:e(n==="true"?"You have been successfully logged out":"You have not been logged out")})}function Dn(e){const t=document.getElementById("auth-ui-payload");if(t!=null&&t.textContent){const n=go(t.textContent),r=e.deserialize(n);if(r)return r}return null}function mo(e,t){return function({request:n}){const r=new URL(n.url),s=r.searchParams.get(e);if(!s)return new Error("missing challenge");const a=Dn(t);if(a){const i=r.searchParams.get("error");return i?{payload:a,challenge:s,errorCode:i}:{payload:a,challenge:s}}return new Error("failed to load payload")}}function Wl(){return function({request:e}){const n=new URL(e.url).searchParams.get("consent_challenge");if(!n)return new Error("missing challenge");const r=Dn(He);if(r!=null&&r.clientName)return{payload:r,challenge:n};const s=Dn(Xt);return s!=null&&s.oidcHandoff?{payload:s,challenge:n}:new Error("failed to load payload")}}function Hl(){return function({request:e}){const n=new URL(e.url).searchParams.get("response");return n?{payload:le.deserialize(JSON.parse(n))}:new Error("missing response")}}const Gl=ss(as(o.jsxs(Le,{path:"/",errorElement:o.jsx(oi,{}),children:[o.jsx(Le,{index:!0,element:o.jsx(er,{})}),o.jsx(Le,{path:"/login",element:o.jsx(Fl,{}),loader:mo("login_challenge",le)}),o.jsx(Le,{path:"/consent",element:o.jsx(ti,{}),loader:Wl()}),o.jsx(Le,{path:"/logout",element:o.jsx(Ul,{}),loader:mo("logout_challenge",Qo)}),o.jsx(Le,{path:"/logout_complete",element:o.jsx(zl,{})}),o.jsx(Le,{path:"/password_reset_complete",element:o.jsx(jr,{shouldShowLoginButton:!1})}),o.jsx(Le,{path:"/sso/callback",element:o.jsx(Bl,{}),loader:Hl()}),o.jsx(Le,{path:"/error",element:o.jsx(si,{})}),o.jsx(Le,{path:"/expired",element:o.jsx(ri,{})})]}))),Vl=o.jsx(is,{router:Gl});function S(e){return"".concat(e,"px")}const ho=Ye(({colorScheme:e})=>({fontWeight:"bold",color:"".concat(e,".500"),_hover:{color:Vs("".concat(e,".500"),.4),textDecoration:"none"}})),ql=$s({defaultProps:{colorScheme:"brand"},baseStyle:{borderRadius:"base",fontSize:S(17),fontWeight:"semibold",paddingVertical:"md",textDecoration:"none",minH:"24px",minW:"24px",_hover:{textDecoration:"none"}},variants:{link:ho,ghost:ho,solid:Ye(({colorScheme:e})=>({borderWidth:S(2),borderColor:"".concat(e,".500"),_hover:{borderColor:"".concat(e,".600"),textDecoration:"none"},_active:{borderColor:"".concat(e,".700")}})),outline:Ye(({colorScheme:e})=>({borderWidth:S(2),borderColor:"".concat(e,".500"),color:"".concat(e,".600"),_hover:{backgroundColor:"".concat(e,".600"),borderColor:"".concat(e,".600"),color:"white",textDecoration:"none"},_active:{backgroundColor:"".concat(e,".700"),borderColor:"".concat(e,".700"),color:"white"}})),social:Ye(({colorScheme:e})=>({borderWidth:S(1),borderColor:"".concat(e,".700"),color:"".concat(e,".800"),_hover:{backgroundColor:"".concat(e,".600"),borderColor:"".concat(e,".600"),color:"white"}}))},sizes:{sm:Ye({fontSize:S(j.buttonSmallFontSize),py:"sm",px:"mdSm",height:"auto"}),md:Ye({fontSize:S(j.buttonFontSize),py:"md",px:"mdSm",height:"auto"}),lg:Ye({fontSize:S(j.buttonLargeFontSize),py:"md",px:"mdLg",height:"auto"})}}),{definePartsStyle:Tt,defineMultiStyleConfig:Kl}=Gt(zs.keys),Yl=Kl({baseStyle:Tt({field:{px:S(j.inputPaddingX),py:S(j.inputPaddingY),lineHeight:j.inputLineHeight}}),variants:{outline:Tt({field:{border:"none",borderColor:j.inputBorderColor,borderRadius:S(j.inputBorderRadius),borderWidth:S(j.borderWidth),borderStyle:"solid",_hover:{borderColor:j.inputBorderColor},_focus:{borderColor:j.colorBorderFocus},_focusVisible:{outline:"none",boxShadow:"none",borderColor:j.colorBorderFocus,_invalid:{borderColor:Qn}},_invalid:{borderColor:Qn}}}),"pin-input":Tt({field:{width:S(40),height:S(50),fontSize:S(20),fontWeight:"bold",padding:0,borderRadius:0,textAlign:"center"}})},sizes:{md:Tt({field:{height:"48px"}})}}),{definePartsStyle:Xl,defineMultiStyleConfig:Jl}=Gt(Ws.keys);function Ql(e){switch(e){case"success":return{backgroundColor:j.alertSuccessBackground,borderColor:j.alertSuccessBorder,color:j.alertSuccessText};case"error":return{backgroundColor:j.alertDangerBackground,borderColor:j.alertDangerBorder,color:j.alertDangerText};case"warning":return{backgroundColor:j.alertWarningBackground,borderColor:j.alertWarningBorder,color:j.alertWarningText};case"info":return{backgroundColor:j.alertInfoBackground,borderColor:j.alertInfoBorder,color:j.alertInfoBorder};default:return{}}}const Zl=Jl({baseStyle:Xl(({status:e})=>({container:{borderRadius:"base",fontSize:"sm",fontWeight:"semibold",...Ql(e)}}))}),{definePartsStyle:Dr,defineMultiStyleConfig:ec}=Gt(Hs.keys),Ir=Dr({header:{fontWeight:"bold",color:"blue.800"}}),tc=Dr({dialog:{p:"mdLg",gap:"md",m:"sm",textAlign:"center"},dialogContainer:{alignItems:"center"},header:{padding:0,fontSize:"subheader"},body:{padding:0},footer:{alignItems:"stretch",flexDirection:"column",gap:"md",padding:0}}),nc=ec({baseStyle:Ir,variants:{alertDialog:tc}}),{definePartsStyle:oc,defineMultiStyleConfig:rc}=Gt(Gs.keys),sc=oc({dialog:{backgroundColor:"transparent",alignItems:"center",px:"md"}}),ac=rc({baseStyle:Ir,variants:{bottomDrawer:sc}}),ic={config:{disableTransitionOnChange:!1},styles:{body:{color:j.colorTextDefault,lineHeight:j.lineHeight,fontSize:j.baseFontSize}},fonts:{body:j.primaryFont.join(", "),heading:j.primaryFont.join(", ")},fontSizes:{sm:S(j.smallFontSize),header:S(j.headerFontSize5),subheader:S(j.headerFontSize6)},fontWeights:{light:j.fontWeightLight,normal:j.fontWeightRegular,semibold:j.fontWeightSemibold,bold:j.fontWeightBold,extrabold:j.fontWeightExtrabold},colors:{white:ls,black:cs,gray:{50:us,100:ds,200:fs,300:ps,400:ms,500:hs,600:_s,700:gs,800:ws,900:xs},blue:{50:bs,100:ys,200:vs,300:js,400:Cs,500:Ps,600:Zn,700:ks,800:Es,900:Ds},red:{50:Is,100:Ts,200:Ls,300:As,400:Rs,500:Os,600:Ss,700:Ms,800:Fs,900:Bs},brand:{500:Us,600:Zn,700:Ns}},space:{xxs:S(j.spaceXxs),xs:S(j.spaceXs),sm:S(j.spaceSm),mdSm:S(j.spaceMdSm),md:S(j.spaceMd),mdLg:S(j.spaceMdLg),lg:S(j.spaceLg),xl:S(j.spaceXl),xxl:S(j.spaceXxl)},sizes:{icon:S(64),iconModal:S(28),iconSm:S(24)},radii:{base:S(j.borderRadius)},components:{Alert:Zl,Button:ql,Drawer:ac,Input:Yl,Heading:{baseStyle:{fontWeight:"bold",color:"blue.800"},sizes:{xl:{fontSize:"header"}}},Link:{baseStyle:{textDecoration:"underline",color:"brand.600"}},AlertDialogFooter:{baseStyle:{justifyContent:"center",flexDirection:"column"}},Modal:nc}},lc=Oo(ic);window.requestIdleCallback=window.requestIdleCallback||function(e){return setTimeout(function(){const t=Date.now();e({didTimeout:!1,timeRemaining(){return Math.max(0,50-(Date.now()-t))}})},1)};window.cancelIdleCallback=window.cancelIdleCallback||function(e){clearTimeout(e)};ua();const cc=fa(),uc=qs({key:"auth-ui",nonce:K.CSP_NONCE_VALUE});Js(K.CSP_NONCE_VALUE);function dc(){const{i18n:e}=bo(),t=l.useMemo(()=>e.dir(),[e]);l.useEffect(()=>{document.body.dir=t},[t]);const n=l.useMemo(()=>Oo({direction:t,...lc}),[t]);return o.jsx(Ys,{value:uc,children:o.jsx(ce,{children:o.jsx(cc,{FallbackComponent:tr,children:o.jsxs(Xs,{theme:n,children:[o.jsx(_a,{}),o.jsx(jo,{my:"lg",children:o.jsxs(ma,{children:[o.jsx(M,{alignContent:"start",gap:"mdLg",children:Vl}),o.jsx(ka,{})]})})]})})})})}Ks.createRoot(document.getElementById("root")).render(o.jsx(dc,{}));const fc=""+window.CDN_URL+"assets/bn-CwKT_tSZ.json",pc=Object.freeze(Object.defineProperty({__proto__:null,default:fc},Symbol.toStringTag,{value:"Module"})),mc=""+window.CDN_URL+"assets/de-DCKhPNmU.json",hc=Object.freeze(Object.defineProperty({__proto__:null,default:mc},Symbol.toStringTag,{value:"Module"})),_c=""+window.CDN_URL+"assets/en-B0dC5_ZI.json",gc=Object.freeze(Object.defineProperty({__proto__:null,default:_c},Symbol.toStringTag,{value:"Module"})),wc=""+window.CDN_URL+"assets/es-DoYm4aiy.json",xc=Object.freeze(Object.defineProperty({__proto__:null,default:wc},Symbol.toStringTag,{value:"Module"})),bc=""+window.CDN_URL+"assets/fr-DxeLqVso.json",yc=Object.freeze(Object.defineProperty({__proto__:null,default:bc},Symbol.toStringTag,{value:"Module"})),vc=""+window.CDN_URL+"assets/hi-EQGnv-sT.json",jc=Object.freeze(Object.defineProperty({__proto__:null,default:vc},Symbol.toStringTag,{value:"Module"})),Cc=""+window.CDN_URL+"assets/it-DixdseQJ.json",Pc=Object.freeze(Object.defineProperty({__proto__:null,default:Cc},Symbol.toStringTag,{value:"Module"})),kc=""+window.CDN_URL+"assets/ja-CF9HGpcf.json",Ec=Object.freeze(Object.defineProperty({__proto__:null,default:kc},Symbol.toStringTag,{value:"Module"})),Dc=""+window.CDN_URL+"assets/ko-FGykd-Op.json",Ic=Object.freeze(Object.defineProperty({__proto__:null,default:Dc},Symbol.toStringTag,{value:"Module"})),Tc=""+window.CDN_URL+"assets/nl-GcNaRBtM.json",Lc=Object.freeze(Object.defineProperty({__proto__:null,default:Tc},Symbol.toStringTag,{value:"Module"})),Ac=""+window.CDN_URL+"assets/pl-BZHtz-nm.json",Rc=Object.freeze(Object.defineProperty({__proto__:null,default:Ac},Symbol.toStringTag,{value:"Module"})),Oc=""+window.CDN_URL+"assets/pt-RXtObhkC.json",Sc=Object.freeze(Object.defineProperty({__proto__:null,default:Oc},Symbol.toStringTag,{value:"Module"})),Mc=""+window.CDN_URL+"assets/ro-E01i-FxS.json",Fc=Object.freeze(Object.defineProperty({__proto__:null,default:Mc},Symbol.toStringTag,{value:"Module"})),Bc=""+window.CDN_URL+"assets/th-C_uRSpeL.json",Uc=Object.freeze(Object.defineProperty({__proto__:null,default:Bc},Symbol.toStringTag,{value:"Module"})),Nc=""+window.CDN_URL+"assets/tl-0eJRk7Ay.json",$c=Object.freeze(Object.defineProperty({__proto__:null,default:Nc},Symbol.toStringTag,{value:"Module"})),zc=""+window.CDN_URL+"assets/tr-Ccf0teXA.json",Wc=Object.freeze(Object.defineProperty({__proto__:null,default:zc},Symbol.toStringTag,{value:"Module"})),Hc=""+window.CDN_URL+"assets/vi-CinSc4XB.json",Gc=Object.freeze(Object.defineProperty({__proto__:null,default:Hc},Symbol.toStringTag,{value:"Module"})),Vc=""+window.CDN_URL+"assets/zh_CN-BKZSjFxt.json",qc=Object.freeze(Object.defineProperty({__proto__:null,default:Vc},Symbol.toStringTag,{value:"Module"}));export{Xc as __vite_legacy_guard,nu as a,tu as b,Zc as c,eu as g};
//# sourceMappingURL=https://remitlyweb-assets-prod.int.remitly.com/auth-ui/index-CmxH_Dba.js.map
